
<!DOCTYPE html>
<html lang="zh-Hans" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>王权伟の博客 - 好记性不如烂笔头</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="王权伟,爱奇艺"> 
    <meta name="description" content="好记性不如烂笔头,Overview本文将讲解实现类似爱奇艺iOS客户端泡泡UI的几种实现以及几种实现可能出现的坑。  
爱奇艺iOS客户端首页底部有5个按钮UITabBar实现，最右边一个是泡泡按钮，点击泡泡按钮将会,"> 
    <meta name="author" content="王权伟"> 
    <link rel="alternative" href="atom.xml" title="王权伟の博客" type="application/atom+xml"> 
    <link rel="icon" href="/img/avatar.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
</head>

<body class="loading">
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">iOS 轻量级社会化组件Trochilus使用指北</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>
    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">iOS 轻量级社会化组件Trochilus使用指北</h1>
        <div class="stuff">
            <span>七月 24, 2017</span>
            

        </div>
        <div class="content markdown">
            <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>Trochilus是iOS轻量级社会化组件(支持:免SDK支付、打赏、分享、授权)。  </p>
<p>现已支持以下平台:    </p>
<p>QQ (QQ好友分享、QQ空间分享、QQ授权)<br>微信 (微信好友分享、微信朋友圈分享、微信收藏、小程序分享、微信授权、微信支付)<br>微博 (微博分享、微博授权)<br>支付宝 (支付宝支付、支付宝打赏)</p>
<a id="more"></a>
<h1 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h1><p>1、无需导入以下系统库(framework、tbd)</p>
<p>QQ平台  </p>
<p><del>libiconv.dylib<br>SystemConfiguration.framework<br>CoreGraphics.Framework<br>libsqlite3.dylib<br>CoreTelephony.framework<br>libstdc++.dylib<br>libz.dylib</del></p>
<p>微信平台  </p>
<p><del>SystemConfiguration.framework<br>libz.dylib<br>libsqlite3.0.dylib<br>libc++.dylib<br>Security.framework<br>CoreTelephony.framework<br>CFNetwork.framework</del></p>
<p>微博平台  </p>
<p><del>ImageIO.framework<br>libsqlite3.dylib</del>  </p>
<p>支付宝平台  </p>
<p><del>CFNetwork.framework<br>SystemConfiguration.framework<br>CoreGraphics.framework<br>CoreMotion.framework<br>CoreTelephony.framework<br>CoreText.framework<br>libc++.tbd<br>libz.tbd</del>  </p>
<p>2、无需导入各个平台SDK  </p>
<p><del>QQSDK<br>微信SDK<br>微博SDK<br>支付宝SDK</del></p>
<p>3、各个平台回调Trochilus内部自动处理。  </p>
<p>4、解决iOS9 or latter左上角返回，不触发回调的问题。  </p>
<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><ul>
<li>[ ] 必填参数验证(当必填参数未填时返回错误信息)</li>
<li>[ ] CocoaPods支持</li>
<li>[ ] 日志系统</li>
</ul>
<h1 id="快速使用"><a href="#快速使用" class="headerlink" title="快速使用"></a>快速使用</h1><p>打开AppDelegate.m导入头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;Trochilus/Trochilus.h&gt;</div></pre></td></tr></table></figure>
<p>在- (BOOL)application: didFinishLaunchingWithOptions:方法中调用registerPlatforms方法来初始化第三方平台</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</div><div class="line">    // Override point for customization after application launch.</div><div class="line">    </div><div class="line">    NSArray * platforms = @[</div><div class="line">                            @(TrochilusPlatformTypeSinaWeibo),</div><div class="line">                            @(TrochilusPlatformTypeQQ),</div><div class="line">                            @(TrochilusPlatformTypeWechat)</div><div class="line">                            ];</div><div class="line">    </div><div class="line">    [Trochilus registerPlatforms:platforms onConfiguration:^(TrochilusPlatformType platformType, NSMutableDictionary *appInfo) &#123;</div><div class="line">        </div><div class="line">        switch (platformType) &#123;</div><div class="line">            case TrochilusPlatformTypeSinaWeibo:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetSinaWeiboByAppKey:kSinaWeiboAppKey</div><div class="line">                                             appSecret:kSinaWeiboAppSecret</div><div class="line">                                           redirectUri:kSinaWeiboRedirectUri];</div><div class="line">                </div><div class="line">                break;</div><div class="line">            case TrochilusPlatformTypeQQ:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetQQByAppId:kQQAppId</div><div class="line">                                        appKey:kQQAppKey</div><div class="line">                                        useTIM:NO];</div><div class="line">                break;</div><div class="line">            case TrochilusPlatformTypeWechat:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetWeChatByAppId:kWeChatAppId</div><div class="line">                                         appSecret:kWeChatAppSecret];</div><div class="line">                </div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>(注意：每一个case对应一个break不要忘记填写，不然很可能有不必要的错误。）</p>
<h3 id="分享"><a href="#分享" class="headerlink" title="分享"></a>分享</h3><p>添加以下代码，分享之后的效果需要去对应的分享平台上观看，首先要构造分享参数，然后再根据每个平台的方法定制自己想要分享的不同的分享内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">NSMutableDictionary * parameters = [NSMutableDictionary dictionary];</div><div class="line"></div><div class="line">//QQ好友分享</div><div class="line">[parameters trochilusSetQQParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                 title:nil</div><div class="line">                                   url:nil</div><div class="line">                         audioFlashURL:nil</div><div class="line">                         videoFlashURL:nil</div><div class="line">                            thumbImage:nil</div><div class="line">                                images:nil</div><div class="line">                                  type:self.type];</div><div class="line">                           </div><div class="line">//微信好友分享</div><div class="line">[parameters trochilusSetWeChatParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                     title:nil</div><div class="line">                                       url:nil</div><div class="line">                              mediaTagName:nil</div><div class="line">                             messageAction:nil</div><div class="line">                                thumbImage:nil</div><div class="line">                                     image:nil</div><div class="line">                              musicFileURL:nil</div><div class="line">                                   extInfo:nil</div><div class="line">                                  fileData:nil</div><div class="line">                             fileExtension:nil</div><div class="line">                              emoticonData:nil</div><div class="line">                                      type:TrochilusContentTypeText];</div><div class="line"></div><div class="line">//微信小程序分享</div><div class="line">[parameters trochilusSetWeChatMiniProgramShareParamsByWebpageUrl:@&quot;http://www.wangquanwei.com/&quot;</div><div class="line">                                                        userName:@&quot;gh_d43f693ca31f&quot;</div><div class="line">                                                            path:@&quot;/page/API/pages/share/share&quot;</div><div class="line">                                                           title:@&quot;MiniProgram&quot;</div><div class="line">                                                     description:@&quot;test MiniProgram&quot;</div><div class="line">                                                      thumbImage:thumbImage</div><div class="line">                                                     hdThumImage:thumbImage</div><div class="line">                                                 withShareTicket:YES</div><div class="line">                                                     contentType:TrochilusContentTypeMiniProgram</div><div class="line">                                                 miniProgramType:TrochilusMiniProgramTypeRelease];</div><div class="line"></div><div class="line">//微博分享</div><div class="line">[parameters trochilusSetSinaWeiboShareParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                             title:nil</div><div class="line">                                             image:nil</div><div class="line">                                               url:nil</div><div class="line">                                          latitude:0</div><div class="line">                                         longitude:0</div><div class="line">                                          objectID:nil</div><div class="line">                                              type:TrochilusContentTypeText];</div><div class="line">//分享</div><div class="line">[Trochilus shareWithPlatformType:&#123;分享平台&#125; parameters:parameters onStateChanged:^(TrochilusResponseState state, NSDictionary *userData, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;分享成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;分享失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>更多可以参考文件 (Trochilus / Category / NSMutableDictionary+TrochilusShare)中的方法。</p>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><p>把如下代码复制并粘贴到你要登录的位置,并且修改相应的参数即可。<br>这里以QQ登陆为例<br>（其他的平台也一样的处理，修改下登陆方法里authorize的平台类型参数：微信登录－&gt; TrochilusPlatformTypeWechat,新浪微博登录－&gt;TrochilusPlatformTypeSinaWeibo。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">[Trochilus authorizeWithPlatformType:TrochilusPlatformTypeQQ settings:nil onStateChanged:^(TrochilusResponseState state, TrochilusUser *user, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;授权成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;授权失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h3 id="支付"><a href="#支付" class="headerlink" title="支付"></a>支付</h3><p>首先要构造支付参数，然后再根据每个平台调用不同的方法。<br>支付涉及到敏感数据，参数全隐去。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">//微信支付</div><div class="line">NSMutableDictionary * wechatPay = [NSMutableDictionary dictionary];</div><div class="line">[wechatPay payWithWechatPartnerId:&#123;partnerId&#125;</div><div class="line">                             prepayId:&#123;prepayId&#125;</div><div class="line">                             nonceStr:&#123;nonceStr&#125;</div><div class="line">                            timeStamp:@&quot;1499752264&quot;</div><div class="line">                              package:@&quot;Sign=WXPay&quot; //iOS微信支付package只能为Sign=WXPay</div><div class="line">                                 sign:&#123;sign&#125;];</div><div class="line">                                 </div><div class="line">[Trochilus wechatPayWithParameters:wechatPay onStateChanged:^(TrochilusResponseState state,NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;支付成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;支付失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStatePayWait: &#123;</div><div class="line">                </div><div class="line">                //iOS9 or later 左上角返回app时 返回TrochilusResponseStatePayWait状态，客户端需要自己去服务器查询是否支付成功</div><div class="line">                </div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">//支付宝支付</div><div class="line">NSString * urlScheme = &#123;urlScheme&#125;;</div><div class="line">NSString * orderString = &#123;由服务器返回构造好的支付字符串&#125;;</div><div class="line"></div><div class="line">[Trochilus aliPayWithUrlScheme:urlScheme orderString:orderString onStateChanged:^(TrochilusResponseState state, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;支付成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;支付失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStatePayWait: &#123;</div><div class="line">                </div><div class="line">                //iOS9 or later 左上角返回app时 返回TrochilusResponseStatePayWait状态，客户端需要自己去服务器查询是否支付成功</div><div class="line">                </div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h3 id="适配iOS9-系统"><a href="#适配iOS9-系统" class="headerlink" title="适配iOS9+系统"></a>适配iOS9+系统</h3><p>1、http 问题:<br>在iOS9下，系统默认会拦截对http协议接口的访问，因此无法获取http协议接口的数据。对Trochilus来说，可能无法获取用户信息。<br>解决方法:<br>在项目的info.plist中添加一个Key：App Transport Security Settings，类型为字典类型。然后给它添加一个Key：Allow Arbitrary Loads，类型为Boolean类型，值为YES。</p>
<p><img src="https://img.wangquanwei.com/Trochilus1.png" alt="">  </p>
<p>2、白名单 问题：<br>在iOS 9下涉及到平台客户端跳转，系统会自动到项目info.plist下检测是否设置平台Scheme。对于需要配置的平台，如果没有配置，就无法正常跳转平台客户端。因此要支持客户端的分享和授权等，需要配置Scheme名单。<br>解决方法:<br>在项目的info.plist中添加一LSApplicationQueriesSchemes，类型为Array。然后给它添加一个需要支持的项目，类型为字符串类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">	&lt;string&gt;wechat&lt;/string&gt;</div><div class="line">	&lt;string&gt;weixin&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibohd&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibo&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibosso&lt;/string&gt;</div><div class="line">	&lt;string&gt;weibosdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;weibosdk2.5&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqq&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqOpensdkSSoLogin&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqconnect&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkdataline&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkgrouptribeshare&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkfriend&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapiV2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapiV3&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginmqq&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginmqq2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqwpa&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzone&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzonev2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneshare&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginqzone&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzonewx&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapiV2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapi19&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;alipay&lt;/string&gt;</div><div class="line">	&lt;string&gt;alipayshare&lt;/string&gt;</div><div class="line">&lt;/array&gt;</div></pre></td></tr></table></figure>
<p><img src="https://img.wangquanwei.com/Trochilus2.png" alt=""></p>
<h3 id="URL-Scheme"><a href="#URL-Scheme" class="headerlink" title="URL Scheme"></a>URL Scheme</h3><p>别忘了配置URL Scheme否则将无法返回客户端。<br>具体规则请看各个平台文档。</p>
<h1 id="Support-or-Contact"><a href="#Support-or-Contact" class="headerlink" title="Support or Contact"></a>Support or Contact</h1><p>在使用Trochilus过程中有任何问题，都可以添加一个<a href="https://github.com/quanweiwang/Trochilus/issues" target="_blank" rel="external">issues</a>，我会及时解决。如果您想贡献代码，欢迎Pull Requests。</p>
<h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="https://github.com/quanweiwang/Trochilus" target="_blank" rel="external">Trochilus https://github.com/quanweiwang/Trochilus</a></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title='0' data-url='https://link.hhtjim.com/qq/001T7NTt0GE6RU.mp3'></li>
                    
                        <li title='1' data-url='https://link.hhtjim.com/qq/002aZAIe1gk8KL.mp3'></li>
                    
                        <li title='2' data-url='https://link.hhtjim.com/qq/003MNjHn3MgszW.mp3'></li>
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='9df2b9438a95189bb534'
        data-cs='149a3805a8ee33d02fadd626cac3e8239c494596'
        data-r='quanweiwang.github.io'
        data-o='quanweiwang'
        data-a='quanweiwang'
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>