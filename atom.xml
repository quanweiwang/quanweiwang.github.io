<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>王权伟の博客</title>
  <subtitle>好记性不如烂笔头</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.wangquanwei.com/"/>
  <updated>2019-01-07T10:03:38.103Z</updated>
  <id>http://www.wangquanwei.com/</id>
  
  <author>
    <name>王权伟</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>iOS 爱奇艺客户端多个UITabBar的几种技术实现</title>
    <link href="http://www.wangquanwei.com/2018-12-07-1.html"/>
    <id>http://www.wangquanwei.com/2018-12-07-1.html</id>
    <published>2018-12-07T03:46:08.000Z</published>
    <updated>2019-01-07T10:03:38.103Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>本文将讲解实现类似爱奇艺iOS客户端泡泡UI的几种实现以及几种实现可能出现的坑。  </p>
<p>爱奇艺iOS客户端首页底部有5个按钮UITabBar实现，最右边一个是泡泡按钮，点击泡泡按钮将会push到一个带有UITabBar的界面(第一次见到这种设计)。 </p>
<p>截止本文发表时爱奇艺iOS客户端版本为V9.10.0，已经改了泡泡界面，不再是push到一个带有UITabBar的界面。  </p>
<a id="more"></a>
<h4 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h4><p>1、实现UITabBarControllerDelegate</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">@interface IQIYITabBarController ()&lt;UITabBarControllerDelegate&gt;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation IQIYITabBarController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    // Do any additional setup after loading the view.</div><div class="line">    self.delegate = self;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>2、实现 -tabBarController:shouldSelectViewController:方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController&#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="第一种实现-使用模态视图"><a href="#第一种实现-使用模态视图" class="headerlink" title="第一种实现 使用模态视图"></a>第一种实现 使用模态视图</h4><p>使用模态视图并修改模态视图的弹出动画为push的形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController &#123;</div><div class="line">    </div><div class="line">    //4是泡泡页面</div><div class="line">    if ([viewController isEqual:[tabBarController.viewControllers objectAtIndex:4]]) &#123;</div><div class="line">        </div><div class="line">        SecondTabBarController * vc = [[SecondTabBarController alloc] init];</div><div class="line">        </div><div class="line">        CATransition * ansition = [CATransition animation];</div><div class="line">        [ansition setDuration:0.25f];</div><div class="line">        [ansition setType:kCATransitionMoveIn];</div><div class="line">        [ansition setSubtype:kCATransitionFromRight];</div><div class="line">        [[UIApplication sharedApplication].keyWindow.layer addAnimation:ansition forKey:nil];</div><div class="line">        [self presentViewController:vc animated:NO completion:nil];</div><div class="line">        </div><div class="line">        return NO;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>模态视图的返回<br>详情见文末的demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    // Do any additional setup after loading the view.</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor groupTableViewBackgroundColor];</div><div class="line">    </div><div class="line">    UIBarButtonItem * leftBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@&quot;返回&quot; style:(UIBarButtonItemStyleDone) target:self action:@selector(back)];</div><div class="line">    </div><div class="line">    self.navigationItem.leftBarButtonItem = leftBarButtonItem;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)back &#123;</div><div class="line">    </div><div class="line">        CATransition * ansition = [CATransition animation];</div><div class="line">        [ansition setDuration:0.25f];</div><div class="line">        [ansition setType:kCATransitionMoveIn];</div><div class="line">        [ansition setSubtype:kCATransitionFromLeft];</div><div class="line">        [[UIApplication sharedApplication].keyWindow.layer addAnimation:ansition forKey:nil];</div><div class="line">        [self dismissViewControllerAnimated:NO completion:nil];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>效果如下图(gif图，如果不会动请刷新)  </p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/iyiqi_gif1.gif" alt="image"><br><br></div>

<p>弊端<br>gif图可能看的不是很清楚。  </p>
<p>弊端就是在push 或者 pop动画执行时会看到黑影闪过，如果要求不高的可以使用这个。</p>
<p>为了解决这个问题，我们引出第二种实现方案</p>
<h4 id="第二种实现-使用UINavigationController-push的形式"><a href="#第二种实现-使用UINavigationController-push的形式" class="headerlink" title="第二种实现 使用UINavigationController push的形式"></a>第二种实现 使用UINavigationController push的形式</h4><p>导航栏push的方式<br>还是先实现前置条件里的代码  </p>
<p>接着实现以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController &#123;</div><div class="line">    </div><div class="line">    //4是泡泡页面</div><div class="line">    if ([viewController isEqual:[tabBarController.viewControllers objectAtIndex:4]]) &#123;</div><div class="line">        </div><div class="line">        SecondTabBarController * vc = [[SecondTabBarController alloc] init];</div><div class="line">        vc.hidesBottomBarWhenPushed = YES;</div><div class="line">        </div><div class="line">        </div><div class="line">        UINavigationController * nav = tabBarController.viewControllers[tabBarController.selectedIndex];</div><div class="line">        [nav pushViewController:vc animated:YES];</div><div class="line">        </div><div class="line">        return NO;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意事项<br>要在第二个TabBar里隐藏掉最外层的导航栏，否则将可能出现2个导航栏的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (void)viewWillAppear:(BOOL)animated &#123;</div><div class="line">    [super viewWillAppear:animated];</div><div class="line">    </div><div class="line">    [self.navigationController setNavigationBarHidden:YES animated:animated];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)viewWillDisappear:(BOOL)animated &#123;</div><div class="line">    [super viewWillDisappear:animated];</div><div class="line">    </div><div class="line">    [self.navigationController setNavigationBarHidden:NO animated:animated];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>一定要使用-setNavigationBarHidden:animated:这个方法来显示隐藏导航栏，并且动画效果不要写YES或者NO要用animated，否则将会出现导航栏黑边闪一下或者手势时出现黑边的情况。</p>
<p>效果如下图(gif图，如果不会动请刷新)</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/iyiqi_gif2.gif" alt="image"><br><br></div>

<h4 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h4><p><a href="https://github.com/quanweiwang/iQIYIDemo" target="_blank" rel="external">https://github.com/quanweiwang/iQIYIDemo</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;本文将讲解实现类似爱奇艺iOS客户端泡泡UI的几种实现以及几种实现可能出现的坑。  &lt;/p&gt;
&lt;p&gt;爱奇艺iOS客户端首页底部有5个按钮UITabBar实现，最右边一个是泡泡按钮，点击泡泡按钮将会push到一个带有UITabBar的界面(第一次见到这种设计)。 &lt;/p&gt;
&lt;p&gt;截止本文发表时爱奇艺iOS客户端版本为V9.10.0，已经改了泡泡界面，不再是push到一个带有UITabBar的界面。  &lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>Xcode Instruments系列之Leaks使用教程</title>
    <link href="http://www.wangquanwei.com/2019-01-29-1.html"/>
    <id>http://www.wangquanwei.com/2019-01-29-1.html</id>
    <published>2018-12-06T06:17:08.000Z</published>
    <updated>2019-01-29T14:53:03.098Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://img.wangquanwei.com/6D25636D-3D33-41C4-A402-713292D833AF" alt="image"></p>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>最近几天在进行公司项目的测试，用到了Leaks进行内存泄露的检测。<br>鉴于网上千篇一律的旧版教程，变萌生了写一篇针对新版Xcode面向萌新的教程。</p>
<a id="more"></a>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p>Xcode 10.1<br>Instruments</p>
<h3 id="唤起Instruments面板"><a href="#唤起Instruments面板" class="headerlink" title="唤起Instruments面板"></a>唤起Instruments面板</h3><p>1、打开Xcode<br>2、按住command + I 或者 菜单栏Product - Profile（选择真机）<br><img src="https://img.wangquanwei.com/C3DC9C88-A44F-4334-B391-35D7036470B6.png" alt="image"><br>等待项目编译通过即可打开Instruments面板</p>
<h3 id="Leaks的使用"><a href="#Leaks的使用" class="headerlink" title="Leaks的使用"></a>Leaks的使用</h3><p>1、选择Leaks双击 或者 按 choose<br><img src="https://img.wangquanwei.com/C1BDBB05-BAC2-4F76-8D62-78EAD5798BA3.png" alt="image"><br>2、打开Leaks面板<br><img src="https://img.wangquanwei.com/6299A396-5B4D-4BBD-A4FE-7203A60FDAFC.png" alt="image"><br>3、点击左上角红色点，即可运行内存检测<br>4、在运行过程中如果发现Leak Checks（如图）出现红色X说明检测到内存泄露,将鼠标点击Leak Checks，在下方即可看到内存泄漏的相关信息<br><img src="https://img.wangquanwei.com/3B6883BE-B886-42CE-8A00-A0ADF6FA8641.png" alt="image"><br>5、定位内存泄露代码位置(如图)<br>第一步：选择Leaks有时候默认是 Run lssues（如图）<br><img src="https://img.wangquanwei.com/4F946E3A-26BF-4B0F-BE3D-F771B1A538D2.png" alt="image"><br>第二步：选择Call Tree<br><img src="https://img.wangquanwei.com/917D51E0-573C-496E-A568-F70FD251EA8E.png" alt="image"><br>然后呢都是一堆内存地址无法知晓哪里出现问题（如图）<br><img src="https://img.wangquanwei.com/86C47B1F-8047-420D-97B8-A0FD5C82AA8D.png" alt="image"><br>第三步：选择底部的Call Tree在弹窗中选择Invert Call Tree 和 Hide System Libraries，即可显示出具体内存泄漏的代码，但假如还不显示请看第四步（如图）<br><img src="https://img.wangquanwei.com/2603FB30-7FD9-4984-B614-C44C9B899CE7.png" alt="image"><br>第四步：如果第三步还无法定位到具体代码，则<br>点击项目工程文件-Buidl Setting-All-搜索Debug Information Format-Debug里选择DWARF with dSYM File（如图）<br><img src="https://img.wangquanwei.com/097DD3E6-FB64-4EC4-922E-2A0D34FB6DBE.png" alt="image"><br>然后重新编译启动Leaks重复上面1-3步骤即可定位到具体代码<br><img src="https://img.wangquanwei.com/29672EA6-83A1-41D8-860A-840D663B47ED.png" alt="image">  </p>
<p>例如这里就是我使用第三方库blocksKit，这个库存在内存泄漏<br><img src="https://img.wangquanwei.com/0B5B9306-ECA7-4901-A491-627CFF912D82.png" alt="image"></p>
<h3 id="查看内存泄漏引用图"><a href="#查看内存泄漏引用图" class="headerlink" title="查看内存泄漏引用图"></a>查看内存泄漏引用图</h3><p>将Call Tree选项改为Cycles &amp; Roots 即可查看，不是所有的都可以查看。<br><img src="https://img.wangquanwei.com/20233F09-B7B9-4BD1-90CF-22D5367DDBC5.png" alt="image"></p>
<h3 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://img.wangquanwei.com/6D25636D-3D33-41C4-A402-713292D833AF&quot; alt=&quot;image&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h3&gt;&lt;p&gt;最近几天在进行公司项目的测试，用到了Leaks进行内存泄露的检测。&lt;br&gt;鉴于网上千篇一律的旧版教程，变萌生了写一篇针对新版Xcode面向萌新的教程。&lt;/p&gt;
    
    </summary>
    
      <category term="Instruments" scheme="http://www.wangquanwei.com/categories/Instruments/"/>
    
    
  </entry>
  
  <entry>
    <title>WKWebView JS与OC间相互传值调用</title>
    <link href="http://www.wangquanwei.com/2018-12-06-1.html"/>
    <id>http://www.wangquanwei.com/2018-12-06-1.html</id>
    <published>2018-12-06T06:17:08.000Z</published>
    <updated>2019-01-05T05:31:47.689Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://img.wangquanwei.com/2018-12-06-1.png" alt="image"></p>
<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>本文将介绍如何使用WKWebView进行JS与OC、OC与JS间的传值和方法调用。</p>
<h4 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h4><p>1、导入WebKit.framework</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/A2C47263-82A8-4C2C-AE00-8D0F4B2C7A1A.png" alt="image"><br><br></div>

<p>2、声明WKWebView</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()</div><div class="line">@property (nonatomic, strong) WKWebView * webView;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="JS调用OC原生方法"><a href="#JS调用OC原生方法" class="headerlink" title="JS调用OC原生方法"></a>JS调用OC原生方法</h4><p>1、前端在js文件中实现</p>
<p>这里要注意messageHandlers后面跟着的deviceInfo要与原生的定义的一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//有参数</div><div class="line">window.webkit.messageHandlers.deviceInfo.postMessage(&#123;</div><div class="line">        &quot;body&quot;: &quot;buttonActionMessage&quot;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//无参数</div><div class="line">window.webkit.messageHandlers.deviceInfo.postMessage(&quot;&quot;);</div></pre></td></tr></table></figure>
<p>2、iOS 实现WKScriptMessageHandler协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()&lt;WKScriptMessageHandler&gt;</div><div class="line">@property (nonatomic, strong) WKWebView * webView;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>3、iOS 初始化WKWebView  </p>
<p>这里注意[userController addScriptMessageHandler:self name:@”deviceInfo”];<br>这个方法里的deviceInfo要与前端定义的一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    // Do any additional setup after loading the view, typically from a nib.</div><div class="line">    </div><div class="line">    WKWebViewConfiguration *configuration = [[WKWebViewConfiguration alloc] init];</div><div class="line">    WKUserContentController *userController = [[WKUserContentController alloc] init];</div><div class="line">    configuration.userContentController = userController;</div><div class="line">    self.webView = [[WKWebView alloc] initWithFrame:self.view.frame configuration:configuration];</div><div class="line">    [userController addScriptMessageHandler:self name:@&quot;deviceInfo&quot;];</div><div class="line">    </div><div class="line">    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:kURL]];</div><div class="line">    [self.webView loadRequest:request];</div><div class="line">    [self.view addSubview:self.webView];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>4、iOS 实现WKScriptMessageHandler协议方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message &#123;</div><div class="line">    </div><div class="line">    if ([message.name isEqualToString:@&quot;deviceInfo&quot;]) &#123;</div><div class="line">        </div><div class="line">        NSString *deviceInfoStr = message.body;</div><div class="line">        NSLog(@&quot;deviceInfo:%@&quot;, deviceInfoStr);</div><div class="line">        </div><div class="line">        UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;提示&quot; message:@&quot;JS调用的OC回调方法&quot; preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">        UIAlertAction *action = [UIAlertAction actionWithTitle:@&quot;ok&quot; style:UIAlertActionStyleCancel handler:nil];</div><div class="line">        [alert addAction:action];</div><div class="line">        [self presentViewController:alert animated:YES completion:nil];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>message.body就是前端传来的参数</p>
<h4 id="OC调用JS方法"><a href="#OC调用JS方法" class="headerlink" title="OC调用JS方法"></a>OC调用JS方法</h4><p>1、实现WKNavigationDelegate协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()&lt;WKScriptMessageHandler,WKNavigationDelegate&gt;</div><div class="line">@property (nonatomic, strong) WKWebView * webView;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>2、实现WKNavigationDelegate协议的- webView: didFinishNavigation:方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (void)webView:(WKWebView *)webView didFinishNavigation:(WKNavigation *)navigation &#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3、OC调用JS方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (void)webView:(WKWebView *)webView didFinishNavigation:(WKNavigation *)navigation &#123;</div><div class="line">    </div><div class="line">    [webView evaluateJavaScript:@&quot;deviceInfo(&apos;8.3&apos;)&quot; completionHandler:^(id _Nullable result, NSError * _Nullable error) &#123;</div><div class="line">        NSLog(@&quot;ok&quot;);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中deviceInfo(‘8.3’)为前端给出的JS方法名8.3是需要传给前端的参数  </p>
<p>4、注意事项  </p>
<p>以下错误的解决方法</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/WechatIMG45.jpeg" alt="image"><br><br></div>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)evaluateJavaScript:(NSString *)javaScriptString completionHandler:(void (^ _Nullable)(_Nullable id, NSError * _Nullable error))completionHandler;</div></pre></td></tr></table></figure>
<p>一定要在网页加载完成后调用，否则报错  </p>
<p>JS方法一定要放在最外层</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/WechatIMG47.png" alt="image"><br><br></div>

<p>图片出处不详，请作者看到与我联系，侵删</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://img.wangquanwei.com/2018-12-06-1.png&quot; alt=&quot;image&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;本文将介绍如何使用WKWebView进行JS与OC、OC与JS间的传值和方法调用。&lt;/p&gt;
&lt;h4 id=&quot;前置条件&quot;&gt;&lt;a href=&quot;#前置条件&quot; class=&quot;headerlink&quot; title=&quot;前置条件&quot;&gt;&lt;/a&gt;前置条件&lt;/h4&gt;&lt;p&gt;1、导入WebKit.framework&lt;/p&gt;
&lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/A2C47263-82A8-4C2C-AE00-8D0F4B2C7A1A.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;2、声明WKWebView&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;@interface ViewController ()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;@property (nonatomic, strong) WKWebView * webView;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;@end&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>关于WRNavigationBar在XS、XS_Max、XR导航栏高度异常的修复方案</title>
    <link href="http://www.wangquanwei.com/2018-11-01-1.html"/>
    <id>http://www.wangquanwei.com/2018-11-01-1.html</id>
    <published>2018-11-01T14:55:08.000Z</published>
    <updated>2019-01-05T05:37:17.650Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>WRNavigationBar 1.2.0版本在iPhone XS Max、iPhone XR上会出现导航栏高度异常的问题。</p>
<h4 id="导航栏异常的原因"><a href="#导航栏异常的原因" class="headerlink" title="导航栏异常的原因"></a>导航栏异常的原因</h4><p>以下代码只判断了iPhone X设备，所以在真机环境下iPhone XR、iPhone XS、iPhone XS Max会出现导航栏高度异常的问题，但作者在模拟器设备时对设备宽高做了判断，因此模拟器下iPhone XS是正常的。</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)isIphoneX &#123;</div><div class="line">    struct utsname systemInfo;</div><div class="line">    uname(&amp;systemInfo);</div><div class="line">    NSString *platform = [NSString stringWithCString:systemInfo.machine encoding:NSASCIIStringEncoding];</div><div class="line">    if ([platform isEqualToString:@&quot;i386&quot;] || [platform isEqualToString:@&quot;x86_64&quot;]) &#123;</div><div class="line">        // judgment by height when in simulators</div><div class="line">        return (CGSizeEqualToSize([UIScreen mainScreen].bounds.size, CGSizeMake(375, 812)) ||</div><div class="line">                CGSizeEqualToSize([UIScreen mainScreen].bounds.size, CGSizeMake(812, 375)));</div><div class="line">    &#125;</div><div class="line">    BOOL isIPhoneX = [platform isEqualToString:@&quot;iPhone10,3&quot;] || [platform isEqualToString:@&quot;iPhone10,6&quot;];</div><div class="line">    return isIPhoneX;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>1、找到WRNavigationBar.m文件，打开。<br>2、找到isIphoneX方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)isIphoneX &#123;</div><div class="line">    struct utsname systemInfo;</div><div class="line">    uname(&amp;systemInfo);</div><div class="line">    NSString *platform = [NSString stringWithCString:systemInfo.machine encoding:NSASCIIStringEncoding];</div><div class="line">    if ([platform isEqualToString:@&quot;i386&quot;] || [platform isEqualToString:@&quot;x86_64&quot;]) &#123;</div><div class="line">        // judgment by height when in simulators</div><div class="line">        return (CGSizeEqualToSize([UIScreen mainScreen].bounds.size, CGSizeMake(375, 812)) ||</div><div class="line">                CGSizeEqualToSize([UIScreen mainScreen].bounds.size, CGSizeMake(812, 375)));</div><div class="line">    &#125;</div><div class="line">    BOOL isIPhoneX = [platform isEqualToString:@&quot;iPhone10,3&quot;] || [platform isEqualToString:@&quot;iPhone10,6&quot;];</div><div class="line">    return isIPhoneX;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3、将其修改为以下内容，直接复制即可  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)isIphoneX &#123;</div><div class="line">    if ([UIApplication sharedApplication].statusBarFrame.size.height == 44) &#123;</div><div class="line">        return YES;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        return NO;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里是将作者的根据设备判断改为根据状态栏高度判断，目前刘海屏状态栏高度都是44。  </p>
<p>4、这里有个注意点<br>Q: 将isIphoneX方法的实现修改后，下面的判断无法返回正确的数值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">+ (CGFloat)navBarBottom &#123;</div><div class="line">    return [self isIphoneX] ? 88 : 64;</div><div class="line">&#125;</div><div class="line">+ (CGFloat)tabBarHeight &#123;</div><div class="line">    return [self isIphoneX] ? 83 : 49;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>A: 将判断改写即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">+ (CGFloat)navBarBottom &#123;</div><div class="line">    </div><div class="line">    if ([self isIphoneX]) &#123;</div><div class="line">        return 88;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        return 64;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">+ (CGFloat)tabBarHeight &#123;</div><div class="line">    if ([self isIphoneX]) &#123;</div><div class="line">        return 83;</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        return 49;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果没出现问题，请无视，理论上也不应该出现问题的。  </p>
<p>Q: 修改代码后，运行app导航栏高度还是错误的，且clean项目还是无效  </p>
<p>A: 使用cleanmymac将Xcode里的数据清除，重新编译运行app，导航栏就正常了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;WRNavigationBar 1.2.0版本在iPhone XS Max、iPhone XR上会出现导航栏高度异常的问题。&lt;/p&gt;
&lt;h4 id=&quot;导航栏异常的原因&quot;&gt;&lt;a href=&quot;#导航栏异常的原因&quot; class=&quot;headerlink&quot; title=&quot;导航栏异常的原因&quot;&gt;&lt;/a&gt;导航栏异常的原因&lt;/h4&gt;&lt;p&gt;以下代码只判断了iPhone X设备，所以在真机环境下iPhone XR、iPhone XS、iPhone XS Max会出现导航栏高度异常的问题，但作者在模拟器设备时对设备宽高做了判断，因此模拟器下iPhone XS是正常的。&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>Sourcetree + gitee(码云) 使用教程</title>
    <link href="http://www.wangquanwei.com/2018-10-14-1.html"/>
    <id>http://www.wangquanwei.com/2018-10-14-1.html</id>
    <published>2018-10-14T11:33:08.000Z</published>
    <updated>2019-01-05T05:33:12.496Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>本文将介绍Mac环境下sourcetree如何从gitee(码云)Clone代码(以此献给和我一样的小白)</p>
<h4 id="注册、登录gitee-码云"><a href="#注册、登录gitee-码云" class="headerlink" title="注册、登录gitee(码云)"></a>注册、登录gitee(码云)</h4><p>1、打开浏览器 输入<a href="https://gitee.com/" target="_blank" rel="external">https://gitee.com/</a>，点击注册 or 加入码云，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/9FBF24F5-63C2-400C-B7C0-F03B1C803A4A.png" alt="image"><br></div>

<a id="more"></a>
<p>2、填写注册信息，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/C9D2CE79-0046-4592-AC5A-4DB4514E2FF9.png" alt="image"><br></div>

<p>3、登录码云</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/86386939-F24B-4BF9-BECC-6016B83CB3E0.png" alt="image"><br></div>

<h4 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h4><p>1、点击加号创建仓库，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/D5E08E2D-DDF3-44AE-9B4B-25DF9710750E.png" alt="image"><br></div>

<p>2、填写仓库信息，如图  </p>
<blockquote>
<p>私有项目最多支持 5 人协作（如拥有多个私有项目，所有协作人数总计不得超过 5 人）<br>企业项目，更适合使用码云企业版， <a href="https://gitee.com/enterprise_contrast?from=private" target="_blank" rel="external">了解更多 &gt;&gt;</a></p>
</blockquote>
<div align="center"><br><br><img src="https://img.wangquanwei.com/71728BC8-FF3F-451C-9DB9-F3E9F9A25027.png" alt="image"><br></div>

<p>3、创建完成，如图  </p>
<p>至此gitee(码云)上的任务完成</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/4026506F-5D19-4EAE-8F0C-88E9CD42BD44.png" alt="image"><br></div>

<h4 id="Sourcetree"><a href="#Sourcetree" class="headerlink" title="Sourcetree"></a>Sourcetree</h4><p>1、下载sourcetree，如图<br><a href="https://www.sourcetreeapp.com/" target="_blank" rel="external">https://www.sourcetreeapp.com/</a></p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/5F0A3112-215A-4A6B-A2C3-4C06D4C0352E.png" alt="image"><br></div>

<p>2、安装sourcetree，如图<br>2.1、安装</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/5ED8015C-E1DD-4B9E-ADA2-B7F896CFDFB6.png" alt="image"><br></div>

<p>2.2、登录您的Atlassian账户<br>这里我选择使用已有账户，用谷歌账号登录(前提要科学上网)</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/2C0E0849-B79A-4837-B0DD-522B4A1FB5BE.png" alt="image"><br></div>

<p>2.3 Atlassian账户<br>这里可以选择跳过设置，至此sourcetree安装配置完成</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/2A98C4C7-F255-41FC-B4D5-6907844C8C9D.png" alt="image"><br></div>

<h4 id="导入gitee-码云-到sourcetree"><a href="#导入gitee-码云-到sourcetree" class="headerlink" title="导入gitee(码云)到sourcetree"></a>导入gitee(码云)到sourcetree</h4><p>1、找到之前创建的仓库，点击(克隆/下载)，复制地址，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/BA4988F7-5FF6-4EDF-B11C-5856C4B3CAC8.png" alt="image"><br></div>

<p>2、打开sourcetree，选择新建-从URL克隆，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/7DCDD587-8220-488F-B846-43631BED2ECA.png" alt="image"><br></div>

<p>3、输入gitee(码云)复制的https地址,第一次会要你输入账号密码，填入gitee(码云)注册的账号密码即可，如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/C382CDEC-8A6B-4D9F-804F-E666050802F5.png" alt="image"><br><br><img src="https://img.wangquanwei.com/4B222D6D-9172-40EE-A9EE-CD42BD0F04E6.png" alt="image"><br><br><img src="https://img.wangquanwei.com/B7ED498F-6BC0-487D-8F81-75252DF4C9BC.png" alt="image"><br><br></div>

<p>4、完成</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/0AC91107-1D5E-4F50-9FA3-D5DDF4A011AB.png" alt="image"><br></div>

<h4 id="git的使用"><a href="#git的使用" class="headerlink" title="git的使用"></a>git的使用</h4><p>自行百度。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;本文将介绍Mac环境下sourcetree如何从gitee(码云)Clone代码(以此献给和我一样的小白)&lt;/p&gt;
&lt;h4 id=&quot;注册、登录gitee-码云&quot;&gt;&lt;a href=&quot;#注册、登录gitee-码云&quot; class=&quot;headerlink&quot; title=&quot;注册、登录gitee(码云)&quot;&gt;&lt;/a&gt;注册、登录gitee(码云)&lt;/h4&gt;&lt;p&gt;1、打开浏览器 输入&lt;a href=&quot;https://gitee.com/&quot;&gt;https://gitee.com/&lt;/a&gt;，点击注册 or 加入码云，如图&lt;/p&gt;
&lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/9FBF24F5-63C2-400C-B7C0-F03B1C803A4A.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 利用模态视图实现带黑色蒙版的底部弹窗</title>
    <link href="http://www.wangquanwei.com/2018-10-12-1.html"/>
    <id>http://www.wangquanwei.com/2018-10-12-1.html</id>
    <published>2018-10-12T14:42:08.000Z</published>
    <updated>2019-01-05T05:38:26.345Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>炒下冷饭，该篇文章发表于2016-08-07，发表在博客园<a href="https://www.cnblogs.com/wangqw/p/5738777.html" target="_blank" rel="external">https://www.cnblogs.com/wangqw/p/5738777.html</a>，现重新排版发表于此。</p>
<h4 id="友情提醒"><a href="#友情提醒" class="headerlink" title="友情提醒"></a>友情提醒</h4><p>本demo仅适用于iOS8及以上系统。  </p>
<h4 id="使用autolayout-storyboard实现弹窗"><a href="#使用autolayout-storyboard实现弹窗" class="headerlink" title="使用autolayout+storyboard实现弹窗"></a>使用autolayout+storyboard实现弹窗</h4><p>第一步、storyboard创建界面</p>
<p>1、打开storyboard 拖一个UIViewcontroller出来，并与class相关联</p>
<a id="more"></a>
<p>2、拖出一个UIView作为弹窗视图的容器，容器里放置弹窗的内容，容器高度根据具体需求放置。容器放在最底部 </p>
<p>3、放置一个UIButton在容器View的上方间距为0，并把UIButton设置为黑色（用于实现蒙版效果及点击空白处关闭弹窗）</p>
<p>4、约束。底部容器打left、right、bottom、height这个约束。UIButton打 left、right、top、bottom约束 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807175904825-369553193.png" alt="image"><br>底部容器约束<br><br><img src="https://img.wangquanwei.com/714996-20160807180343168-1347233876.png" alt="image"><br>UIButton约束<br></div>

<p>5、约束。将底部容器的bottom约束编辑修改 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807180729684-462217795.png" alt="image"><br>修改容器bottom约束<br><br><img src="https://img.wangquanwei.com/714996-20160807180935434-792688910.png" alt="image"><br>修改容器bottom约束<br><br><img src="https://img.wangquanwei.com/714996-20160807181130700-1845924649.png" alt="image"><br>修改容器bottom约束<br></div>

<p>6、找到底部容器的bottom约束拉线到对应的UIViewController 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807181841497-1876214160.png" alt="image"><br>拉线<br></div>

<p>第二步、设置蒙版及弹窗动画</p>
<p>1、修改UIButton的透明度并把UIViewController的View的背景色设置为透明 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807190653059-1295967993.png" alt="image"><br>设置透明度<br></div>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//千万别设置view的alpha 设置alpha 会导致view下的所有子视图都变透明</div><div class="line">self.view.backgroundColor = [UIColor clearColor];</div><div class="line"></div><div class="line">//设置按钮透明度</div><div class="line">self.dismissBtn.alpha = 0.5f;</div><div class="line">self.dismissBtn.backgroundColor = [UIColor blackColor];</div></pre></td></tr></table></figure>
<p>2、实现弹窗动画，在viewDidAppear中实现，这样才可以看到整个动画过程 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807191214481-1562655370.png" alt="image"><br>修改约束<br></div>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//视图显示完 弹出弹窗</div><div class="line">- (void)viewDidAppear:(BOOL)animated &#123;</div><div class="line">    [super viewDidAppear:animated];</div><div class="line">    </div><div class="line">    //更改视图 底部约束</div><div class="line">    self.viewBottomConstraint.constant = 0;</div><div class="line">    </div><div class="line">    //执行动画</div><div class="line">    [UIView animateWithDuration:0.25 animations:^&#123;</div><div class="line">        </div><div class="line">        //强制更新约束</div><div class="line">        [self.view layoutIfNeeded];</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3、弹出模态视图 如图</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807191933184-189155919.png" alt="image"><br>模态视图<br></div>

<p>请注意看截图，该方法所在类为ViewController<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">####pragma mark- 按钮点击事件</div><div class="line">- (void)popBtn:(UIButton *)btn &#123;</div><div class="line">    </div><div class="line">    UIStoryboard * sb = [UIStoryboard storyboardWithName:@&quot;Main&quot; bundle:nil];</div><div class="line">    QWPopupWindowVC * vc = [sb instantiateViewControllerWithIdentifier:@&quot;QWPopupWindowVC&quot;];</div><div class="line">    vc.providesPresentationContextTransitionStyle = YES;</div><div class="line">    vc.definesPresentationContext = YES;</div><div class="line">    vc.modalPresentationStyle = UIModalPresentationOverCurrentContext;</div><div class="line">    [self presentViewController:vc animated:NO completion:nil];</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>几个属性的解释  </p>
<blockquote>
<p>解释内容摘至博客园 返回主页不打扰是我的温柔 <a href="http://www.cnblogs.com/SenDylan/p/3953832.html" target="_blank" rel="external">http://www.cnblogs.com/SenDylan/p/3953832.html</a>  </p>
</blockquote>
<p>providesPresentationContextTransitionStyle</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807192018106-1442728786.png" alt="image"><br></div>

<p>definesPresentationContext</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807192726481-1498336537.png" alt="image"><br></div>


<p>modalPresentationStyle</p>
<div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807193013293-1451604844.png" alt="image"><br></div><br>部分类容读起来怪怪的，不清楚是不是翻译软件的原因。<br><br>4、关闭弹窗<br><div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807193422418-654040597.png" alt="image"><br>关闭弹窗<br></div>

<h4 id="演示gif"><a href="#演示gif" class="headerlink" title="演示gif"></a>演示gif</h4><div align="center"><br><br><img src="https://img.wangquanwei.com/714996-20160807193807153-800741518.gif" alt="image"><br></div>

<h4 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h4><p><a href="https://github.com/quanweiwang/QWPopupWindow" target="_blank" rel="external">demo下载</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;炒下冷饭，该篇文章发表于2016-08-07，发表在博客园&lt;a href=&quot;https://www.cnblogs.com/wangqw/p/5738777.html&quot;&gt;https://www.cnblogs.com/wangqw/p/5738777.html&lt;/a&gt;，现重新排版发表于此。&lt;/p&gt;
&lt;h4 id=&quot;友情提醒&quot;&gt;&lt;a href=&quot;#友情提醒&quot; class=&quot;headerlink&quot; title=&quot;友情提醒&quot;&gt;&lt;/a&gt;友情提醒&lt;/h4&gt;&lt;p&gt;本demo仅适用于iOS8及以上系统。  &lt;/p&gt;
&lt;h4 id=&quot;使用autolayout-storyboard实现弹窗&quot;&gt;&lt;a href=&quot;#使用autolayout-storyboard实现弹窗&quot; class=&quot;headerlink&quot; title=&quot;使用autolayout+storyboard实现弹窗&quot;&gt;&lt;/a&gt;使用autolayout+storyboard实现弹窗&lt;/h4&gt;&lt;p&gt;第一步、storyboard创建界面&lt;/p&gt;
&lt;p&gt;1、打开storyboard 拖一个UIViewcontroller出来，并与class相关联&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS12 Xcode10 升级后报错临时解决方案</title>
    <link href="http://www.wangquanwei.com/2018-09-18-1.html"/>
    <id>http://www.wangquanwei.com/2018-09-18-1.html</id>
    <published>2018-09-18T04:11:08.000Z</published>
    <updated>2019-01-05T05:33:24.533Z</updated>
    
    <content type="html"><![CDATA[<div align="center"><br><br><img src="https://dingyue.nosdn.127.net/HJZuEuCFDQDkHTF=Y6EkDohLuH7BlDWGqjgC0byV6wfvd1520979271974.jpg" alt="image"><br><br>图片来源百度图片<br><br></div>

<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>本篇文章写于2018.09.18 星期二</p>
<h4 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h4><p>Q: 重复的info.plist<br>A: 删除即可(把第三方库的info.plist删除)  </p>
<a id="more"></a>
<p>Q: library not found for -lstdc++.6.0.9<br>A: 从Xcode9.4.1复制  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">真机路径: </div><div class="line">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/libstdc++  </div><div class="line"></div><div class="line">模拟器路径: </div><div class="line">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/usr/lib/libstdc++</div><div class="line">#### Xcode10</div></pre></td></tr></table></figure>
<p>Q: libstdc++、libstdc++.6 错误<br>A: 未知(Xcode9.4.1里没找到该库)，重新安装Xcode9.4.1</p>
<p>以上问题等第三方更新完，再使用Xcode10吧</p>
<h4 id="Xcode9-真机编译iOS12"><a href="#Xcode9-真机编译iOS12" class="headerlink" title="Xcode9 真机编译iOS12"></a>Xcode9 真机编译iOS12</h4><p>1、下载Xcode10<br>2、安装Xcode10<br>3、选中Xcode10-&gt;右键显示包内容-&gt;Contents-&gt;Developer-&gt;Platforms-&gt;iPhoneOS.platform-&gt;DeviceSupport-&gt;把12.0 (16A366)文件夹复制到Xcode9的相同目录下即可  </p>
<p>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport</p>
<h4 id="Xcode10-正式版-尝鲜"><a href="#Xcode10-正式版-尝鲜" class="headerlink" title="Xcode10 正式版(尝鲜)"></a>Xcode10 正式版(尝鲜)</h4><p><a href="https://download.developer.apple.com/Developer_Tools/Xcode_10/Xcode_10.xip" target="_blank" rel="external">https://download.developer.apple.com/Developer_Tools/Xcode_10/Xcode_10.xip</a></p>
<h4 id="Xcode9-4-1"><a href="#Xcode9-4-1" class="headerlink" title="Xcode9.4.1"></a>Xcode9.4.1</h4><p><a href="https://download.developer.apple.com/Developer_Tools/Xcode_9.4.1/Xcode_9.4.1.xip" target="_blank" rel="external">https://download.developer.apple.com/Developer_Tools/Xcode_9.4.1/Xcode_9.4.1.xip</a></p>
<h4 id="更多版本"><a href="#更多版本" class="headerlink" title="更多版本"></a>更多版本</h4><p><a href="https://developer.apple.com/download/more/" target="_blank" rel="external">https://developer.apple.com/download/more/</a>  </p>
<p>ps:访问该页面需要登录账号，否则将会跳转到登录页面或者开发者首页。</p>
]]></content>
    
    <summary type="html">
    
      &lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://dingyue.nosdn.127.net/HJZuEuCFDQDkHTF=Y6EkDohLuH7BlDWGqjgC0byV6wfvd1520979271974.jpg&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;br&gt;图片来源百度图片&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;本篇文章写于2018.09.18 星期二&lt;/p&gt;
&lt;h4 id=&quot;已知问题&quot;&gt;&lt;a href=&quot;#已知问题&quot; class=&quot;headerlink&quot; title=&quot;已知问题&quot;&gt;&lt;/a&gt;已知问题&lt;/h4&gt;&lt;p&gt;Q: 重复的info.plist&lt;br&gt;A: 删除即可(把第三方库的info.plist删除)  &lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>让mac系统终端支持ss的代理</title>
    <link href="http://www.wangquanwei.com/2018-07-28-1.html"/>
    <id>http://www.wangquanwei.com/2018-07-28-1.html</id>
    <published>2018-07-28T13:18:08.000Z</published>
    <updated>2019-01-05T05:33:30.846Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>近期发现github似乎被GFW给墙了，在终端向github提交博客文章一直失败，然而终端默认不支持ss代理。<br>本文将介绍mac系统下如何让终端支持ss代理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RPC failed; curl 55 SSL_write() returned SYSCALL, errno = 32</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>1、搭建一个ss，具体的百度、谷歌。<br>2、下载ShadowsocksX-NG，具体下载地址百度、谷歌。<br>3、运行ShadowsocksX-NG，右键点小飞机，然后有一个Copy HTTP Proxy Shell Export Line，点击之后会copy命令。</p>
<p><img src="https://img.wangquanwei.com/6B8B6DA9-C3E3-4BCF-986F-36B12CE02B68.png" alt="image">  </p>
<p>4、到终端paste，回车即可。<br><img src="https://img.wangquanwei.com/FF6D32B9-166B-4517-B6BF-B8B599AC3FDC.png" alt="image"></p>
<p>这样终端就可以使用ss科学上网啦。</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://github.com/hexojs/hexo/issues/231" target="_blank" rel="external">https://github.com/hexojs/hexo/issues/231</a>  </p>
<p><a href="https://github.com/shadowsocks/ShadowsocksX-NG/issues/147" target="_blank" rel="external">https://github.com/shadowsocks/ShadowsocksX-NG/issues/147</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;近期发现github似乎被GFW给墙了，在终端向github提交博客文章一直失败，然而终端默认不支持ss代理。&lt;br&gt;本文将介绍mac系统下如何让终端支持ss代理。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;RPC failed; curl 55 SSL_write() returned SYSCALL, errno = 32&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>Cannot modify constraints for UITabBar managed by a controller</title>
    <link href="http://www.wangquanwei.com/2018-06-25-1.html"/>
    <id>http://www.wangquanwei.com/2018-06-25-1.html</id>
    <published>2018-06-25T04:43:08.000Z</published>
    <updated>2019-01-05T05:33:36.604Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>近期在开发偶遇优选2.0时遇到一个奇葩异常：Cannot modify constraints for UITabBar managed by a controller。</p>
<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><blockquote>
<p>自动布局只能使用在UIViews及其子类，也就是说工具栏之类的不能使用。</p>
</blockquote>
<a id="more"></a>
<h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p><img src="https://img.wangquanwei.com/%E9%A6%96%E9%A1%B5.jpg" alt="image"></p>
<p>给UITabbarController的tabbar addSubView子视图（即红色线条那块），然后给子视图设置约束导致的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">self.bottomLineView = [[UIView alloc] init];</div><div class="line">self.bottomLineView.backgroundColor = RGB_HEX(0xcc5253);</div><div class="line">[self.tabBar addSubview:self.bottomLineView];</div><div class="line"></div><div class="line">[self.bottomLineView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.left.equalTo(self.tabBar);</div><div class="line">    make.width.equalTo(self.bottomLineViewWidth);</div><div class="line">    make.top.equalTo(self.tabBar);</div><div class="line">    make.height.equalTo(3);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>查阅api发现<br><img src="https://img.wangquanwei.com/875B69FE-847B-43C6-8FE6-6FA93147E7A6.png" alt="image"></p>
<blockquote>
<p>// Provided for -[UIActionSheet showFromTabBar:]. Attempting to modify  the contents of the tab bar directly will throw an exception.  </p>
<p>//提供-[UIActionSheet showFromTabBar:]。尝试直接修改选项卡栏的内容将抛出异常。</p>
</blockquote>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">self.bottomLineView = [[UIView alloc] initWithFrame:CGRectMake(0, -3, self.bottomLineViewWidth, 3)];</div><div class="line">self.bottomLineView.backgroundColor = RGB_HEX(0xcc5253);</div><div class="line">[self.tabBar addSubview:self.bottomLineView];</div></pre></td></tr></table></figure>
<p>即把autolayout改为传统的计算frame。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;近期在开发偶遇优选2.0时遇到一个奇葩异常：Cannot modify constraints for UITabBar managed by a controller。&lt;/p&gt;
&lt;h4 id=&quot;结论&quot;&gt;&lt;a href=&quot;#结论&quot; class=&quot;headerlink&quot; title=&quot;结论&quot;&gt;&lt;/a&gt;结论&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;自动布局只能使用在UIViews及其子类，也就是说工具栏之类的不能使用。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>UITableView Header Footer View使用autolayout时报约束异常的解决方法</title>
    <link href="http://www.wangquanwei.com/2018-06-11-1.html"/>
    <id>http://www.wangquanwei.com/2018-06-11-1.html</id>
    <published>2018-06-11T03:37:08.000Z</published>
    <updated>2019-01-05T05:33:43.139Z</updated>
    
    <content type="html"><![CDATA[<div align="center"><br><br><img src="https://img.wangquanwei.com/ios7_dev.png" alt="image"><br><br></div>

<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>近期在开发偶遇优选2.0时遇到一个奇葩问题：UITableViewHeaderFooterView使用autolayout时报约束异常，但显示上一切正常。经过一番排查，约束并无冲突。网上有看到说因为使用了复用才会出现这问题，这里并不是通过取消复用来解决此问题。虽问题解决，但甚是不解。望大神答疑解惑。<br><a id="more"></a></p>
<div align="center"><br><br><img src="https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=653c67e15efbb2fb202650402e234bc1/8cb1cb1349540923e1860cc29958d109b2de499a.jpg" alt="image"><br><br></div>

<h4 id="异常示例"><a href="#异常示例" class="headerlink" title="异常示例"></a>异常示例</h4><div align="center"><br><br><img src="https://img.wangquanwei.com/B3A05CE1-FC4F-4B37-9892-0404DAF8D7F9.png" alt="image"><br><br></div><br>上图红框部分用到了UITableViewHeaderFooterView，作为section的头，并不是UITableView的headerView。<br><br><br>这是初始化了UITableViewHeaderFooterView子视图的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div></pre></td><td class="code"><pre><div class="line">- (void)initUI &#123;</div><div class="line">    </div><div class="line">    self.contentView.backgroundColor = [UIColor whiteColor];</div><div class="line">    </div><div class="line">    //商家logo</div><div class="line">    self.logoImageView = [[UIImageView alloc] init];</div><div class="line">    self.logoImageView.backgroundColor = RGB_HEX(0xffffff);</div><div class="line">    self.logoImageView.layer.borderWidth = 1.f;</div><div class="line">    self.logoImageView.layer.borderColor = RGB_HEX(0xbfbfbf).CGColor;</div><div class="line">    self.logoImageView.layer.cornerRadius = 50/2.f;</div><div class="line">    self.logoImageView.clipsToBounds = YES;</div><div class="line">    [self addSubview:self.logoImageView];</div><div class="line">    </div><div class="line">    //店铺名</div><div class="line">    self.storeNameLabel = [[UILabel alloc] init];</div><div class="line">    self.storeNameLabel.font = [UIFont boldSystemFontOfSize:kHeight(32)];</div><div class="line">    self.storeNameLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    [self addSubview:self.storeNameLabel];</div><div class="line">    </div><div class="line">    //套餐背景视图</div><div class="line">    self.comboImageView = [[UIImageView alloc] init];</div><div class="line">//    self.comboImageView.contentMode = UIViewContentModeScaleAspectFit;</div><div class="line">    self.comboImageView.image = [UIImage imageNamed:@&quot;order_rectangle&quot;];</div><div class="line">    [self addSubview:self.comboImageView];</div><div class="line">    </div><div class="line">    //套餐视图</div><div class="line">    self.comboView = [[UIView alloc] init];</div><div class="line">    self.comboView.clipsToBounds = YES;</div><div class="line">    self.comboView.layer.cornerRadius = 4.f;</div><div class="line">    [self addSubview:self.comboView];</div><div class="line">    </div><div class="line">    //商品图片</div><div class="line">    self.merchandiseImageView = [[UIImageView alloc] init];</div><div class="line">    self.merchandiseImageView.clipsToBounds = YES;</div><div class="line">    self.merchandiseImageView.contentMode = UIViewContentModeScaleAspectFill;</div><div class="line">//    self.merchandiseImageView.backgroundColor = [UIColor randomColor];</div><div class="line">    [self.comboView addSubview:self.merchandiseImageView];</div><div class="line">    </div><div class="line">    //商品标题</div><div class="line">    self.titleLabel = [[UILabel alloc] init];</div><div class="line">    self.titleLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    self.titleLabel.font = [UIFont boldSystemFontOfSize:kHeight(32)];</div><div class="line">    [self.comboView addSubview:self.titleLabel];</div><div class="line">    </div><div class="line">    //有效期</div><div class="line">    self.expirationTimeLabel = [[UILabel alloc] init];</div><div class="line">    self.expirationTimeLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    self.expirationTimeLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(24)];</div><div class="line">    [self.comboView addSubview:self.expirationTimeLabel];</div><div class="line">    </div><div class="line">    //左线条</div><div class="line">    self.leftLineView = [[UIView alloc] init];</div><div class="line">    self.leftLineView.backgroundColor = RGB_HEX(0x000000);</div><div class="line">    [self.comboView addSubview:self.leftLineView];</div><div class="line">    </div><div class="line">    //右线条</div><div class="line">    self.rightLineView = [[UIView alloc] init];</div><div class="line">    self.rightLineView.backgroundColor = RGB_HEX(0x000000);</div><div class="line">    [self.comboView addSubview:self.rightLineView];</div><div class="line">    </div><div class="line">    //当前砍价人数</div><div class="line">    self.currentBargainLabel = [[UILabel alloc] init];</div><div class="line">    self.currentBargainLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    self.currentBargainLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(24)];</div><div class="line">    [self.comboView addSubview:self.currentBargainLabel];</div><div class="line">    </div><div class="line">    //当前价格</div><div class="line">    self.bargainPriceLabel = [[UILabel alloc] init];</div><div class="line">    self.bargainPriceLabel.textColor = RGB_HEX(0xb4282d);</div><div class="line">    self.bargainPriceLabel.font = [UIFont pingFangMediumFontOfSize:kHeight(26)];</div><div class="line">    [self addSubview:self.bargainPriceLabel];</div><div class="line">    </div><div class="line">    //进度条倒三角</div><div class="line">    self.progressTriangleImageView = [[UIImageView alloc] init];</div><div class="line">//    self.progressTriangleImageView.image = [UIImage imageNamed:@&quot;order_progress_triangle&quot;];</div><div class="line">    [self addSubview:self.progressTriangleImageView];</div><div class="line">    </div><div class="line">    //进度条</div><div class="line">    //左右轨的图片</div><div class="line">    UIImage *stetchLeftTrack= [UIImage imageNamed:@&quot;brightness_bar&quot;];</div><div class="line">    UIImage *stetchRightTrack = [UIImage imageNamed:@&quot;brightness_bar_bg&quot;];</div><div class="line">    //滑块图片</div><div class="line">    UIImage *thumbImage = [UIImage imageNamed:@&quot;order_progress_round&quot;];</div><div class="line">    </div><div class="line">    self.slider = [[UISlider alloc] init];</div><div class="line">    self.slider.userInteractionEnabled = NO;</div><div class="line">//    self.slider.enabled = NO; //禁止滑动</div><div class="line">    [self.slider setMinimumTrackImage:stetchLeftTrack forState:UIControlStateNormal];</div><div class="line">    [self.slider setMaximumTrackImage:stetchRightTrack forState:UIControlStateNormal];</div><div class="line">    //注意这里要加UIControlStateHightlighted的状态，否则当拖动滑块时滑块将变成原生的控件</div><div class="line">    [self.slider setThumbImage:thumbImage forState:UIControlStateHighlighted];</div><div class="line">    [self.slider setThumbImage:thumbImage forState:UIControlStateNormal];</div><div class="line">    [self addSubview:self.slider];</div><div class="line">    </div><div class="line">    //优选价</div><div class="line">    self.originalPriceLabel = [[UILabel alloc] init];</div><div class="line">    self.originalPriceLabel.numberOfLines = 2;</div><div class="line">    self.originalPriceLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    self.originalPriceLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(26)];</div><div class="line">    </div><div class="line">    [self addSubview:self.originalPriceLabel];</div><div class="line">    </div><div class="line">    //最惠价</div><div class="line">    self.preferentialPriceLabel = [[UILabel alloc] init];</div><div class="line">    self.preferentialPriceLabel.numberOfLines = 2;</div><div class="line">    self.preferentialPriceLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    self.preferentialPriceLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(26)];</div><div class="line">    [self addSubview:self.preferentialPriceLabel];</div><div class="line">    </div><div class="line">    //底部分割线</div><div class="line">    self.bottomLineView = [[UIView alloc] init];</div><div class="line">    self.bottomLineView.backgroundColor = RGB_HEX(0xF2F2F2);</div><div class="line">    [self addSubview:self.bottomLineView];</div><div class="line">    </div><div class="line">    //砍价人数</div><div class="line">    self.bargainNumLabel = [[UILabel alloc] init];</div><div class="line">    self.bargainNumLabel.font = [UIFont pingFangMediumFontOfSize:kHeight(30)];</div><div class="line">    [self addSubview:self.bargainNumLabel];</div><div class="line">    </div><div class="line">    //约束</div><div class="line">    </div><div class="line">    //头像</div><div class="line">    [self.logoImageView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.centerX.equalTo(self);</div><div class="line">        make.top.equalTo(self).offset(kHeight(30));</div><div class="line">        make.width.height.equalTo(50);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //店铺名</div><div class="line">    [self.storeNameLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.right.equalTo(self);</div><div class="line">        make.top.equalTo(self.logoImageView.bottom).offset(kHeight(26));</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    //套餐视图</div><div class="line">    [self.comboView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.top.equalTo(self.storeNameLabel.bottom).offset(kHeight(34));</div><div class="line">        make.left.equalTo(self).offset(kWidth(52));</div><div class="line">        make.right.equalTo(self).offset(-kWidth(52));</div><div class="line">        make.height.equalTo(kHeight(586));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //套餐背景视图</div><div class="line">    [self.comboImageView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.top.equalTo(self.comboView).offset(-kHeight(10));</div><div class="line">        make.left.equalTo(self.comboView).offset(-kWidth(16));</div><div class="line">        make.right.equalTo(self.comboView).offset(kWidth(16));</div><div class="line">        make.bottom.equalTo(self.comboView).offset(kHeight(10));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //商品图片</div><div class="line">    [self.merchandiseImageView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.top.left.right.equalTo(self.comboView);</div><div class="line">        make.height.equalTo(kHeight(308));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //标题</div><div class="line">    [self.titleLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.right.equalTo(self.comboView);</div><div class="line">        make.top.equalTo(self.merchandiseImageView.bottom).offset(kHeight(46));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //截止日期</div><div class="line">    [self.expirationTimeLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.centerX.equalTo(self.titleLabel);</div><div class="line">        make.top.equalTo(self.titleLabel.bottom).offset(kHeight(26));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //左线条</div><div class="line">    [self.leftLineView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.right.equalTo(self.expirationTimeLabel.left).offset(-kWidth(28));</div><div class="line">        make.centerY.equalTo(self.expirationTimeLabel);</div><div class="line">        make.width.equalTo(kWidth(20));</div><div class="line">        make.height.equalTo(1);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //右线条</div><div class="line">    [self.rightLineView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.equalTo(self.expirationTimeLabel.right).offset(14);</div><div class="line">        make.centerY.equalTo(self.expirationTimeLabel);</div><div class="line">        make.width.equalTo(kWidth(20));</div><div class="line">        make.height.equalTo(1);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //当前参与砍价人数</div><div class="line">    [self.currentBargainLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.right.equalTo(self);</div><div class="line">        make.top.equalTo(self.expirationTimeLabel.bottom).offset(kHeight(30));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //进度条</div><div class="line">    [self.slider makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.top.equalTo(self.comboView.bottom).offset(kHeight(110));</div><div class="line">        make.left.equalTo(self).offset(kWidth(50));</div><div class="line">        make.right.equalTo(self).offset(-kWidth(50));</div><div class="line">        make.height.equalTo(3);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //倒三角</div><div class="line">    [self.progressTriangleImageView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.bottom.equalTo(self.slider.top).equalTo(-kHeight(16));</div><div class="line">        make.left.equalTo(self.slider.left);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //当前价格</div><div class="line">    [self.bargainPriceLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.equalTo(self.slider.left);</div><div class="line">        make.bottom.equalTo(self.progressTriangleImageView.top).offset(-kHeight(10));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //优选价</div><div class="line">    [self.originalPriceLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.equalTo(self.slider);</div><div class="line">        make.top.equalTo(self.slider.bottom).offset(kHeight(16));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //最惠价</div><div class="line">    [self.preferentialPriceLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.right.equalTo(self.slider);</div><div class="line">        make.top.equalTo(self.slider.bottom).offset(kHeight(16));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //底部分割线</div><div class="line">    [self.bottomLineView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.right.equalTo(self);</div><div class="line">        make.top.equalTo(self.preferentialPriceLabel.bottom).offset(kHeight(70));</div><div class="line">        make.height.equalTo(kHeight(20));</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    //砍价好友</div><div class="line">    [self.bargainNumLabel makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.equalTo(self).offset(kWidth(30));</div><div class="line">        make.right.equalTo(self).offset(-kWidth(30));</div><div class="line">        make.top.equalTo(self.bottomLineView.bottom).offset(kHeight(30));</div><div class="line">        make.bottom.equalTo(self);</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure><br><br>这是初始化UITableView的代码<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">- (void)initUI &#123;</div><div class="line">    </div><div class="line">    self.title = @&quot;砍价&quot;;</div><div class="line">    </div><div class="line">    self.view.backgroundColor = [UIColor whiteColor];</div><div class="line">    </div><div class="line">    self.table = [UITableView customTableViewWithFrame:CGRectZero</div><div class="line">                                                 style:UITableViewStyleGrouped</div><div class="line">                                        separatorColor:[UIColor clearColor]</div><div class="line">                          estimatedSectionHeaderHeight:UITableViewAutomaticDimension</div><div class="line">                          estimatedSectionFooterHeight:UITableViewAutomaticDimension];</div><div class="line">    self.table.hidden = YES;</div><div class="line">    self.table.backgroundColor = [UIColor whiteColor];</div><div class="line">    self.table.showsVerticalScrollIndicator = NO;</div><div class="line">    self.table.showsHorizontalScrollIndicator = NO;</div><div class="line">    self.table.delegate = self;</div><div class="line">    self.table.dataSource = self;</div><div class="line">    [self.table registerClass:[VCBargainHeaderView class] forHeaderFooterViewReuseIdentifier:@&quot;VCBargainHeaderView&quot;];</div><div class="line">    [self.table registerClass:[VCBargainFriendsCell class] forCellReuseIdentifier:@&quot;VCBargainFriendsCell&quot;];</div><div class="line">    [self.view addSubview:self.table];</div><div class="line">    </div><div class="line">    //底部视图</div><div class="line">    self.bottomView = [[UIView alloc] init];</div><div class="line">    self.bottomView.backgroundColor = [UIColor whiteColor];</div><div class="line">    self.bottomView.hidden = YES;</div><div class="line">    [self.view addSubview:self.bottomView];</div><div class="line">    </div><div class="line">    //分享按钮</div><div class="line">    self.shareBargainBtn = [[UIButton alloc] init];</div><div class="line">    self.shareBargainBtn.layer.cornerRadius = 4.f;</div><div class="line">    self.shareBargainBtn.titleLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(30)];</div><div class="line">    self.shareBargainBtn.backgroundColor = RGB_HEX(0xcc5253);</div><div class="line">    [self.shareBargainBtn setTitle:@&quot;分享砍价&quot; forState:UIControlStateNormal];</div><div class="line">    [self.bottomView addSubview:self.shareBargainBtn];</div><div class="line">    </div><div class="line">    //立即使用</div><div class="line">    self.useBtn = [[UIButton alloc] init];</div><div class="line">    self.useBtn.layer.cornerRadius = 4.f;</div><div class="line">    self.useBtn.layer.borderColor = RGB_HEX(0xb4282d).CGColor;</div><div class="line">    self.useBtn.layer.borderWidth = 1.f;</div><div class="line">    self.useBtn.titleLabel.font = [UIFont pingFangRegularFontOfSize:kHeight(30)];</div><div class="line">    [self.useBtn setTitle:@&quot;立即使用&quot; forState:UIControlStateNormal];</div><div class="line">    [self.useBtn setTitleColor:RGB_HEX(0xb4282d) forState:UIControlStateNormal];</div><div class="line">    [self.bottomView addSubview:self.useBtn];</div><div class="line">    </div><div class="line">    //约束</div><div class="line">    [self.bottomView makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        </div><div class="line">        if (@available(iOS 11.0, *)) &#123;</div><div class="line">            make.left.equalTo(self.view.safeAreaLayoutGuideLeft).offset(0);</div><div class="line">            make.right.equalTo(self.view.safeAreaLayoutGuideRight).offset(0);</div><div class="line">            make.bottom.equalTo(self.view.safeAreaLayoutGuideBottom).offset(0);</div><div class="line">        &#125; else &#123;</div><div class="line">            // Fallback on earlier versions</div><div class="line">            make.left.right.bottom.equalTo(self.view);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        make.height.equalTo(73);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    [self.table makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        </div><div class="line">        if (@available(iOS 11.0, *)) &#123;</div><div class="line">            make.left.equalTo(self.view.safeAreaLayoutGuideLeft).offset(0);</div><div class="line">            make.right.equalTo(self.view.safeAreaLayoutGuideRight).offset(0);</div><div class="line">            make.top.equalTo(self.view.safeAreaLayoutGuideTop).offset(0);</div><div class="line">            </div><div class="line">        &#125; else &#123;</div><div class="line">            // Fallback on earlier versions</div><div class="line">            make.left.right.top.equalTo(self.view);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        make.bottom.equalTo(self.bottomView.top).offset(0);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><br><br>UITableViewHeaderFooterView代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">static NSString * headerViewStr = @&quot;VCBargainHeaderView&quot;;</div><div class="line">- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section &#123;</div><div class="line">    </div><div class="line">    VCBargainHeaderView * bargainHeaderView = [tableView dequeueReusableHeaderFooterViewWithIdentifier:headerViewStr];</div><div class="line">    </div><div class="line">    if (bargainHeaderView == nil) &#123;</div><div class="line">        bargainHeaderView = (VCBargainHeaderView *)[[UITableViewHeaderFooterView alloc] initWithReuseIdentifier:headerViewStr];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [bargainHeaderView setModel:self.viewModel.couponItem];</div><div class="line">    </div><div class="line">    //砍价人数</div><div class="line">    bargainHeaderView.bargainNumLabel.text = [NSString stringWithFormat:@&quot;砍价好友(%d)&quot;,self.viewModel.cutPriceList.count];</div><div class="line">    </div><div class="line">    return bargainHeaderView;</div><div class="line">&#125;</div></pre></td></tr></table></figure><br><br>运行后约束报错<br><br><div align="center"><br><br><img src="https://img.wangquanwei.com/5F77FAD1-DE9E-419C-A367-8D3F7284E648.png" alt="image"><br><br></div>

<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><p>解决方法1：</p>
<div align="center"><br><br>异常代码（约束报错）<br><img src="https://img.wangquanwei.com/67BBB6D7-1D28-48C1-A201-198668CF7D63.png" alt="image"><br><br>正常代码（约束不报错）<br><img src="https://img.wangquanwei.com/1C550D68-D438-4992-915E-3BDF65088405.png" alt="image"><br><br></div>

<p>找到与UITableViewHeaderFooterView底部有约束的控件将他与底部的约束优先级改低。如上图（正常代码）所示 即可解决问题</p>
<p>2、解决方法2（网上看到的，亲测无效）：</p>
<blockquote>
<p>使用UITableView的header或footer复用时，如果采用自动布局，你会发现有约束冲突，下面这样写可以消除约束冲突：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"> ####import &lt;UIKit/UIKit.h&gt;</div><div class="line"> </div><div class="line"> @interface SectionView : UITableViewHeaderFooterView</div><div class="line"> </div><div class="line"> @property (nonatomic, copy) NSString *sectionTitle;</div><div class="line"> </div><div class="line"> @end</div><div class="line"> </div><div class="line"> ####import &quot;SectionView.h&quot;</div><div class="line"> </div><div class="line"> @interface SectionView ()</div><div class="line"> &#123;</div><div class="line">     UIImageView *titleBgImageView;</div><div class="line">     UIImageView *timePonitImageView;</div><div class="line">     UIImageView *circleImageView;</div><div class="line">     UILabel *titleLabe;</div><div class="line"> &#125;</div><div class="line"> @end</div><div class="line"> </div><div class="line"> @implementation SectionView</div><div class="line"> </div><div class="line"> // 带有复用</div><div class="line"> - (instancetype)initWithReuseIdentifier:(NSString *)reuseIdentifier</div><div class="line"> &#123;</div><div class="line">     self = [super initWithReuseIdentifier:reuseIdentifier];</div><div class="line">     if (self) &#123;</div><div class="line">         [self createUI];</div><div class="line">     &#125;</div><div class="line">     return self;</div><div class="line"> &#125;</div><div class="line"> </div><div class="line"> </div><div class="line"> - (void)createUI</div><div class="line"> &#123;</div><div class="line">     titleBgImageView = [[UIImageView alloc] initForAutoLayout];</div><div class="line">     titleBgImageView.userInteractionEnabled = NO;</div><div class="line">     UIImage *image = [UIImage imageNamed:@&quot;event_bottom_line&quot;];</div><div class="line">     image = [image stretchableImageWithLeftCapWidth:image.size.width*0.5 topCapHeight:image.size.height*0.5];</div><div class="line">     titleBgImageView.image = image;</div><div class="line">     [self.contentView addSubview:titleBgImageView];</div><div class="line">     </div><div class="line">     </div><div class="line">     circleImageView = [[UIImageView alloc] initForAutoLayout];</div><div class="line">     UIImage *circleImage = [UIImage imageNamed:@&quot;event_blue1&quot;];</div><div class="line">     circleImage = [circleImage stretchableImageWithLeftCapWidth:circleImage.size.width*0.5 topCapHeight:circleImage.size.height*0.5];</div><div class="line">     </div><div class="line">     circleImageView.image = circleImage;</div><div class="line">     [self.contentView addSubview:circleImageView];</div><div class="line"> </div><div class="line">     </div><div class="line">     timePonitImageView = [[UIImageView alloc] initForAutoLayout];</div><div class="line">     timePonitImageView.image = [UIImage imageNamed:@&quot;event_write_line&quot;];</div><div class="line">     [self.contentView addSubview:timePonitImageView];</div><div class="line">     </div><div class="line">     </div><div class="line">     titleLabe = [[UILabel alloc] initForAutoLayout];</div><div class="line">     titleLabe.font = [UIFont systemFontOfSize:13];</div><div class="line">     titleLabe.textColor = [UIColor whiteColor];</div><div class="line">     titleLabe.textAlignment = NSTextAlignmentCenter;</div><div class="line">     [circleImageView addSubview:titleLabe];</div><div class="line">    </div><div class="line">&#125;</div><div class="line">&gt; </div><div class="line">&gt; 把布局代码写到这里</div><div class="line"> - (void)layoutSubviews</div><div class="line"> &#123;</div><div class="line">     [super layoutSubviews];</div><div class="line">     </div><div class="line">     [titleBgImageView autoPinEdgesToSuperviewEdgesWithInsets:UIEdgeInsetsMake(0, 0, 0, 0)];</div><div class="line">     </div><div class="line">     [circleImageView autoPinEdgeToSuperviewEdge:ALEdgeLeading withInset:8];</div><div class="line">     [circleImageView autoPinEdgeToSuperviewEdge:ALEdgeTrailing withInset:8];</div><div class="line">     [circleImageView autoSetDimension:ALDimensionHeight toSize:23];</div><div class="line">     [circleImageView autoAlignAxisToSuperviewAxis:ALAxisHorizontal];</div><div class="line">    </div><div class="line">    [timePonitImageView autoPinEdgeToSuperviewEdge:ALEdgeLeading withInset:16];</div><div class="line">     [timePonitImageView autoPinEdgeToSuperviewEdge:ALEdgeTop withInset:39/2.0-4];</div><div class="line">    [timePonitImageView autoSetDimensionsToSize:CGSizeMake(9, 23.5)];</div><div class="line">    </div><div class="line">     [titleLabe autoCenterInSuperview];</div><div class="line">     [titleLabe autoSetDimension:ALDimensionWidth toSize:200];</div><div class="line">    </div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>该代码来自csdn用户王素燕的博客<a href="https://blog.csdn.net/u010618987/article/details/46744689" target="_blank" rel="external">《UITableViewHeaderFooterView的使用+自动布局》</a>。侵删！</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/ios7_dev.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;近期在开发偶遇优选2.0时遇到一个奇葩问题：UITableViewHeaderFooterView使用autolayout时报约束异常，但显示上一切正常。经过一番排查，约束并无冲突。网上有看到说因为使用了复用才会出现这问题，这里并不是通过取消复用来解决此问题。虽问题解决，但甚是不解。望大神答疑解惑。&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS Share Extensions开发教程</title>
    <link href="http://www.wangquanwei.com/2018-03-31-1.html"/>
    <id>http://www.wangquanwei.com/2018-03-31-1.html</id>
    <published>2018-03-31T02:55:08.000Z</published>
    <updated>2019-01-05T05:44:40.202Z</updated>
    
    <content type="html"><![CDATA[<div align="center"><br><br><img src="https://img.wangquanwei.com/2018060110133445277.jpg" alt="image"><br><br></div>

<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><blockquote>
<p>Extension是iOS8新开放的一种对几个固定系统区域的扩展机制，它可以在一定程度上弥补iOS的沙盒机制对应用间通信的限制。  </p>
</blockquote>
<a id="more"></a>
<h4 id="App-Extensions使用限制"><a href="#App-Extensions使用限制" class="headerlink" title="App Extensions使用限制"></a>App Extensions使用限制</h4><p>一个App Extensions不能有以下情况：</p>
<p>1.访问sharedApplication对象</p>
<p>2.使用任何标记NS_EXTENSION_UNAVAILABLE宏的API，或者类似的宏，或者不可用framework里面的API，例如HealthKit framework不能用于App extensions</p>
<p>3.iOS设备访问相机或者麦克风（iMessage app可以访问这些资源，只要在Info.plist里面进行配置使用描述即可）</p>
<p>4.运行一个长时间的后台任务（根据不同平台而异）</p>
<p>5.使用AirDrop接收数据</p>
<h4 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h4><p>注：Share Extension不能单独存在，必须依赖于主体工程。因此在此之前需要先创建个项目，如何创建项目这里不再叙述。  </p>
<p>创建Share Extension<br>File-&gt;New-&gt;Targets-&gt;Share Extension<br><img src="https://img.wangquanwei.com/F97F9BEA-207F-4F17-90EF-60D763F5DE1E.png" alt="image"></p>
<p><img src="https://img.wangquanwei.com/AFDAC595-3F55-440F-AD91-8D47D08F3C3A.png" alt="image"></p>
<p><img src="https://img.wangquanwei.com/93644182-2326-4754-8DF4-80B52777FF24.png" alt="image"></p>
<p><img src="https://img.wangquanwei.com/1BEA5E6D-6307-4CC2-929E-18E32D4F2CBC.png" alt="image"></p>
<h4 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h4><p>现在我们可以运行项目看看效果了。iOS给我们提供了一个默认的UI样式，我们可以根据实际需求自定义UI和功能。<br><img src="https://img.wangquanwei.com/62E81076-F30C-4F4A-AE2E-7E034654433B.png" alt="image">  </p>
<p>这里以简书为例<br>简书-&gt;任意文章打开-&gt;分享-&gt;更多  </p>
<p>信息那一栏滑动就可以看到我们建的share extension了<br><img src="https://img.wangquanwei.com/D04479FE3618CC43E5918D67A08375DE.png" alt="image"></p>
<p>点击我们创建的share extension 这就是默认效果<br><img src="https://img.wangquanwei.com/69C012F4DC8FB1C32E89F70B9E1ED4D6.png" alt="image"></p>
<h4 id="配置-share-extension-info-plist"><a href="#配置-share-extension-info-plist" class="headerlink" title="配置 share extension info.plist"></a>配置 share extension info.plist</h4><blockquote>
<p>Bundle display name</p>
<p>扩展的显示名称，默认跟你的项目名称相同，可以通过修改此字段来控制扩展的显示名称。</p>
<p>NSExtension</p>
<p>扩展描述字段，用于描述扩展的属性、设置等。作为一个扩展项目必须要包含此字段。</p>
<p>NSExtensionAttributes</p>
<p>扩展属性集合字段。用于描述扩展的属性。</p>
<p>NSExtensionActivationRule</p>
<p>激活扩展的规则。默认为字符串“TRUEPREDICATE”，表示在分享菜单中一直显示该扩展。可以将类型改为Dictionary类型，然后添加以下字段：</p>
<p>NSExtensionActivationSupportsAttachmentsWithMaxCount</p>
<p>NSExtensionActivationSupportsAttachmentsWithMinCount</p>
<p>NSExtensionActivationSupportsImageWithMaxCount</p>
<p>NSExtensionActivationSupportsMovieWithMaxCount</p>
<p>NSExtensionActivationSupportsWebPageWithMaxCount</p>
<p>NSExtensionActivationSupportsWebURLWithMaxCount</p>
<p>NSExtensionMainStoryboard</p>
<p>设置主界面的Storyboard，如果不想使用storyboard，也可以使用NSExtensionPrincipalClass指定自定义UIViewController子类名</p>
<p>NSExtensionPointIdentifier</p>
<p>扩展标识，在分享扩展中为：com.Apple.share-services</p>
<p>NSExtensionPrincipalClass</p>
<p>自定义UI的类名</p>
<p>NSExtensionActivationSupportsAttachmentsWithMaxCount</p>
<p>附件最多限制，为数值类型。附件包括File、Image和Movie三大类，单一、混选总量不超过指定数量</p>
<p>NSExtensionActivationSupportsAttachmentsWithMinCount</p>
<p>附件最少限制，为数值类型。当设置NSExtensionActivationSupportsAttachmentsWithMaxCount时生效，默认至少选择1个附件，分享菜单中才显示扩展插件图标。</p>
<p>NSExtensionActivationSupportsFileWithMaxCount</p>
<p>文件最多限制，为数值类型。文件泛指除Image/Movie之外的附件，例如【邮件】附件、【语音备忘录】等。</p>
<p>单一、混选均不超过指定数量。</p>
<p> NSExtensionActivationSupportsImageWithMaxCount</p>
<p>图片最多限制，为数值类型。单一、混选均不超过指定数量。</p>
<p>NSExtensionActivationSupportsMovieWithMaxCount</p>
<p>视频最多限制，为数值类型。单一、混选均不超过指定数量。</p>
<p>NSExtensionActivationSupportsText</p>
<p>是否支持文本类型，布尔类型，默认不支持。如【备忘录】的分享</p>
<p>NSExtensionActivationSupportsWebURLWithMaxCount</p>
<p>Web链接最多限制，为数值类型。默认不支持分享超链接，需要自己设置一个数值。</p>
<p>NSExtensionActivationSupportsWebPageWithMaxCount</p>
<p>Web页面最多限制，为数值类型。默认不支持Web页面分享，需要自己设置一个数值。</p>
</blockquote>
<p>注意事项<br>1、使用storyboard创建UI<br>找到Share Extension的info.plist-&gt;展开NSExtension-&gt;新增key NSExtensionMainStoryboard value MainInterface(即storyboard名称)<br>如果没有修改，键值默认就存在<br><img src="https://img.wangquanwei.com/14594842-3F45-4CD6-A90A-E9F25DC046DE.png" alt="image"></p>
<p>2、使用代码创建界面<br>找到Share Extension的info.plist-&gt;展开NSExtension-&gt;将NSExtensionMainStoryboard这行删掉  </p>
<p>在NSExtension里新增key:NSExtensionPrincipalClass value: 自定义ViewController类名<br><img src="https://img.wangquanwei.com/A8D93D54-B746-45E2-AB49-57A8204E2595.png" alt="image"></p>
<h4 id="自定义UI、自定义功能"><a href="#自定义UI、自定义功能" class="headerlink" title="自定义UI、自定义功能"></a>自定义UI、自定义功能</h4><p>创建完Share Extension时会默认创建一个ShareViewController的类，它继承于SLComposeServiceViewController</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">####import &lt;UIKit/UIKit.h&gt;</div><div class="line">####import &lt;Social/Social.h&gt;</div><div class="line"></div><div class="line">@interface ShareViewController : SLComposeServiceViewController</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>我们在做自定义时可以把他删掉自己重新建个类或者直接拿默认的修改，这里仅拿默认的修改。  </p>
<p>将ShareViewController的继承改成UIViewController,因为我们需要自定义UI，使用SLComposeServiceViewController无法显示自定义UI。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">####import &lt;UIKit/UIKit.h&gt;</div><div class="line">####import &lt;Social/Social.h&gt;</div><div class="line"></div><div class="line">@interface ShareViewController : UIViewController</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>获取别的app传过来的数据 NSExtensionContext是UIViewController里的属性，可以直接使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// Returns the extension context. Also acts as a convenience method for a view controller to check if it participating in an extension request.</div><div class="line">@property (nullable, nonatomic,readonly,strong) NSExtensionContext *extensionContext NS_AVAILABLE_IOS(8_0);</div></pre></td></tr></table></figure>
<p>通过遍历的形式来获取我们需要的数据,这里获取URL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">__block BOOL hasGetUrl = NO;</div><div class="line">[self.extensionContext.inputItems enumerateObjectsUsingBlock:^(NSExtensionItem *  _Nonnull extensionItem, NSUInteger idx, BOOL * _Nonnull stop) &#123;</div><div class="line">    </div><div class="line">    [extensionItem.attachments enumerateObjectsUsingBlock:^(id  _Nonnull itemProvider, NSUInteger idx, BOOL * _Nonnull stop) &#123;</div><div class="line">        </div><div class="line">        if ([itemProvider hasItemConformingToTypeIdentifier:@&quot;public.url&quot;])</div><div class="line">        &#123;</div><div class="line">            [itemProvider loadItemForTypeIdentifier:@&quot;public.url&quot; options:nil completionHandler:^(id&lt;NSSecureCoding&gt;  _Nullable item, NSError * _Null_unspecified error) &#123;</div><div class="line">                </div><div class="line">                if ([(NSObject *)item isKindOfClass:[NSURL class]])</div><div class="line">                &#123;</div><div class="line">                    NSURL * url = (NSURL *)item;</div><div class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">                        </div><div class="line">                        NSURLRequest * request = [NSURLRequest requestWithURL:url];</div><div class="line">                        [self.webView loadRequest:request];</div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">            &#125;];</div><div class="line">            </div><div class="line">            hasGetUrl = YES;</div><div class="line">            *stop = YES;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        *stop = hasGetUrl;</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<p>退出Share Extension<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSError * error = [NSError errorWithDomain:@&quot;GankIOExtension&quot; code:NSUserCancelledError userInfo:nil];</div><div class="line">[self.extensionContext cancelRequestWithError:error];</div></pre></td></tr></table></figure></p>
<p>如果存在网络请求，且非https，请在info.plist里添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">	&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</div><div class="line">	&lt;true/&gt;</div><div class="line">&lt;/dict&gt;</div></pre></td></tr></table></figure>
<p>剩下的该怎么玩就怎么玩，和正常的创建页面，处理逻辑一样</p>
<h4 id="使用cocoapods"><a href="#使用cocoapods" class="headerlink" title="使用cocoapods"></a>使用cocoapods</h4><p>正常情况下我们是无法在Share extension里使用cocoapods的库的，所以我们需要配置一下。这样就可以在extension里使用cocoapods的库啦<br><img src="https://img.wangquanwei.com/4446854F-FC9C-42CB-A9B5-E2EEBB7E9FCE.png" alt="image"></p>
<h4 id="代码共享"><a href="#代码共享" class="headerlink" title="代码共享"></a>代码共享</h4><p>有时候我们想使用主体项目里的一些封装好的方法，例如category之类的，但是不能使用。  </p>
<p>解决办法<br>1、拷贝一份代码到share extension（太sb）<br>2、使用framework来共享代码（推荐）</p>
<p>这里使用方法2来实现代码共享，具体如下：  </p>
<p>1、创建framework<br>File-&gt;New-&gt;Targets-Cocoa Touch Framework<br><img src="https://img.wangquanwei.com/5D8B4E2D-DFD8-4851-86AC-7CA436B6027F.png" alt="image"></p>
<p>2、添加类到framework<br>我们选择需要共享的类，将其添加到framework里  </p>
<p>选中.h文件<br><img src="https://img.wangquanwei.com/2033F15A-3172-42C7-A8A4-07BC84A99E7E.png" alt="image"></p>
<p>选中.m文件<br><img src="https://img.wangquanwei.com/21CEE27F-0AC7-4F61-8C93-5C9353A3B59B.png" alt="image"></p>
<p>找到framework文件夹里的.h文件，将共享的类的头文件添加进去<br><img src="https://img.wangquanwei.com/D4CA10C4-F07D-4BB5-946B-C4AC33E91FF4.png" alt="image"></p>
<p>公开头文件<br><img src="https://img.wangquanwei.com/A7F23627-08FD-41C1-8E06-5B1332A2DEB5.png" alt="image"></p>
<p>最最最重要一步<br>将framework添加到share extension里<br><img src="https://img.wangquanwei.com/B17CE0C8-1F03-4973-B39E-74422D0360BC.png" alt="image"></p>
<p>请遵守app extensions使用限制</p>
<h4 id="发布（此处有坑）"><a href="#发布（此处有坑）" class="headerlink" title="发布（此处有坑）"></a>发布（此处有坑）</h4><p><img src="https://img.wangquanwei.com/A8212F64-4CC0-4A70-B9DF-260BBA19988B.png" alt="image"></p>
<p>1、ERROR ITMS-90362: “Invalid Info.plist value. The value for the key ‘NSExtensionActivationRule’ in bundle      xxxxx is invalid. Please refer to the App Extension Programming Guide on <a href="https://developer.apple.com" target="_blank" rel="external">https://developer.apple.com</a>“</p>
<p>NSExtensionAttributes的默认值是“TRUEPREDICATE”这是供给我们开发时使用的。我们发布时需要对该字段进行修改。</p>
<p><img src="https://img.wangquanwei.com/5348B5B7-7063-4245-88DE-F9A12E49368D.png" alt="image"></p>
<p>例如，要声明您的共享扩展可以支持多达十个图像，一个电影和一个网页URL，您可以使用以下字典来获取该NSExtensionAttributes键的值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;NSExtensionAttributes&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">    &lt;key&gt;NSExtensionActivationRule&lt;/key&gt;</div><div class="line">    &lt;dict&gt;</div><div class="line">        &lt;key&gt;NSExtensionActivationSupportsImageWithMaxCount&lt;/key&gt;</div><div class="line">        &lt;integer&gt;10&lt;/integer&gt;</div><div class="line">        &lt;key&gt;NSExtensionActivationSupportsMovieWithMaxCount&lt;/key&gt;</div><div class="line">        &lt;integer&gt;1&lt;/integer&gt;</div><div class="line">        &lt;key&gt;NSExtensionActivationSupportsWebURLWithMaxCount&lt;/key&gt;</div><div class="line">        &lt;integer&gt;1&lt;/integer&gt;</div><div class="line">    &lt;/dict&gt;</div><div class="line">&lt;/dict&gt;</div></pre></td></tr></table></figure></p>
<p>如果您不支持特定的数据类型，请使用0相应密钥的值或从NSExtensionActivationRule字典中删除密钥。</p>
<p>2、WARNING ITMS-90473: “CFBundleShortVersionString Mismatch. The CFBundleShortVersionString value ‘1.0’ of extension xxxxx does not match the CFBundleShortVersionString value ‘1.1.3’ of its containing iOS application ‘Gank.io.app’.”</p>
<p>这里要求extension的Version和Build版本号要与主体工程的版本号一致</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple_ref/doc/uid/TP40014214-CH21-SW8" target="_blank" rel="external">https://developer.apple.com/library/content/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple_ref/doc/uid/TP40014214-CH21-SW8</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/2018060110133445277.jpg&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Extension是iOS8新开放的一种对几个固定系统区域的扩展机制，它可以在一定程度上弥补iOS的沙盒机制对应用间通信的限制。  &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>今日干货--干货集中营iOS客户端现已加入App Store豪华午餐</title>
    <link href="http://www.wangquanwei.com/2018-03-13-1.html"/>
    <id>http://www.wangquanwei.com/2018-03-13-1.html</id>
    <published>2018-03-13T02:46:08.000Z</published>
    <updated>2019-01-05T05:48:04.649Z</updated>
    
    <content type="html"><![CDATA[<div align="center"><br><br><img src="https://img.wangquanwei.com/gank.io-1.png" alt="gank.io"><br><br></div>

<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>2016年1月11日订阅干货集中营，没翻邮件我自己都忘了。<br>从开始的每天中午一更到现在佛系更新，一路见证了干货集中营的发展历程。</p>
<a id="more"></a>
<h4 id="Gank"><a href="#Gank" class="headerlink" title="Gank"></a>Gank</h4><p>作为干货集中营的老粉丝、老用户，今天带来一款全新的 <a href="http://gank.io/" target="_blank" rel="external">gank.io</a> iOS客户端–今日干货<br><img src="https://img.wangquanwei.com/gankio_1024.png" alt="image">  </p>
<h4 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h4><p>今日干货所有数据均来自干货集中营的开放的API。</p>
<h4 id="界面预览"><a href="#界面预览" class="headerlink" title="界面预览"></a>界面预览</h4><p>首页–最新一期的干货<br><img src="https://img.wangquanwei.com/gank.io-2.png" alt="image">  </p>
<p>历史–往期所有干货列表缩略<br><img src="https://img.wangquanwei.com/gank.io-4.png" alt="image">  </p>
<p>萌妹子–妹子图啦<br><img src="https://img.wangquanwei.com/gank.io-3.png" alt="image">  </p>
<p>我的–乱七八糟的东西<br><img src="https://img.wangquanwei.com/gank.io-5.png" alt="image"></p>
<h4 id="奇怪的技术应用"><a href="#奇怪的技术应用" class="headerlink" title="奇怪的技术应用"></a>奇怪的技术应用</h4><p>Trochilus – 免sdk实现分享、登录、支付<br>应用于历史-分享<br><a href="https://github.com/quanweiwang/Trochilus" target="_blank" rel="external">https://github.com/quanweiwang/Trochilus</a></p>
<p>支付宝打赏 – 免sdk、免扫码打开支付宝付款界面<br>应用于我的-打赏  </p>
<p>打开新浪微博个人中心页面 – 免sdk实现app跳转到新浪微博指定用户个人中心页面<br>应用于我的-系统设置-关于-We are 伐 ~ 木 ~ 累 ~</p>
<h4 id="第三方开源库"><a href="#第三方开源库" class="headerlink" title="第三方开源库"></a>第三方开源库</h4><p>感谢，今日干货的制作离不开以下这些框架开发者！<br><a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="external">AFNetworking </a><br><a href="https://github.com/BlocksKit/BlocksKit" target="_blank" rel="external">BlocksKit</a><br><a href="https://github.com/Flipboard/FLAnimatedImage" target="_blank" rel="external">FLAnimatedImage</a><br><a href="https://github.com/hackiftekhar/IQKeyboardManager" target="_blank" rel="external">IQKeyboardManager</a><br><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="external">Masonry</a><br><a href="https://github.com/jdg/MBProgressHUD" target="_blank" rel="external">MBProgressHUD</a><br><a href="https://github.com/CoderMJLee/MJExtension" target="_blank" rel="external">MJExtension </a><br><a href="https://github.com/CoderMJLee/MJRefresh" target="_blank" rel="external">MJRefresh</a><br><a href="https://github.com/maccman/SDWebImage" target="_blank" rel="external">SDWebImage</a><br><a href="https://github.com/banchichen/TZImagePickerController" target="_blank" rel="external">TZImagePickerController</a><br><a href="https://github.com/wangrui460/WRNavigationBar" target="_blank" rel="external">WRNavigationBar</a><br><a href="https://github.com/CoderXLLau/XLPhotoBrowser" target="_blank" rel="external">XLPhotoBrowser+CoderXL</a></p>
<h4 id="审核过程"><a href="#审核过程" class="headerlink" title="审核过程"></a>审核过程</h4><p>一次被拒<br>Your app includes content that many users would find objectionable and offensive. Specifically, your 萌妹子 section is objectifying females.  </p>
<p>Please see attached screenshots for details.  </p>
<p>Next Steps  </p>
<p>To resolve this issue, please remove all potentially objectionable content from your app and submit your revised binary for review.  </p>
<p>For app design information, check out the following videos: and “Designing Intuitive User Experiences,” available on the Apple Developer website.  </p>
<p>You may also want to review the iOS Human Interface Guidelines for more information on how to create a great user experience in your app.    </p>
<p>你的应用程序包含了很多用户会觉得讨厌和冒犯的内容。具体地说,你的萌妹子部分是物化女性。  </p>
<p>详情请见附件截图。  </p>
<p>下一个步骤  </p>
<p>为了解决这个问题，请从您的应用程序中删除所有潜在的不良内容，并提交您的修订后的二进制文件进行审查。</p>
<p>对于应用程序设计信息，请查看以下视频:“设计直观的用户体验”，可以在苹果开发者网站上找到。</p>
<p>你可能还想回顾一下iOS的人机界面指南，了解更多关于如何在你的应用程序中创建优秀用户体验的信息。</p>
<p>二次被拒</p>
<blockquote>
<p>忘记改截图了  </p>
</blockquote>
<p>We noticed that your screenshots do not sufficiently reflect your app in use.  </p>
<p>Please see attached screenshots for details.  </p>
<p>Next Steps  </p>
<p>To resolve this issue, please revise your screenshots to ensure that they accurately reflect the app in use on the supported devices. For iPhone, you need a set of 5.5-inch display screenshots and for iPad, you need a set for 12.9-inch display. This set will be scaled appropriately down to other device sizes when viewed on the App Store in each territory.  </p>
<p>Resources  </p>
<p>For resources on creating great screenshots for the App Store, you may want to review the App Store Product Page information available on the Apple developer portal.  </p>
<p>Please ensure you have made any screenshot modifications using Media Manager. You should confirm your app looks and behaves identically in all languages and on all supported devices. Learn how to use Media Manager to add custom screenshots for each display size and localization.  </p>
<p>Since your iTunes Connect status is Metadata Rejected, we do NOT require a new binary. To revise the metadata, visit iTunes Connect to select your app and revise the desired metadata values. Once you’ve completed all changes, reply to this message in Resolution Center and we will continue the review.  </p>
<p>NOTE: Please be sure to make any metadata changes to all app localizations by selecting each specific localization and making appropriate changes.    </p>
<p>我们注意到你的截图没有充分反映你的应用。</p>
<p>详情请见附件截图。</p>
<p>下一个步骤  </p>
<p>为了解决这个问题，请修改您的截图，以确保它们能够准确地反映所支持设备上的应用程序。对于iPhone，你需要一套5.5英寸的屏幕截图和iPad，你需要一套12.9英寸的显示屏。当在每个区域的App Store上查看时，这个集合将被适当地缩小到其他设备大小。</p>
<p>资源  </p>
<p>对于为应用程序商店创建大屏幕快照的资源，您可能想要查看苹果开发门户网站上可用的App Store产品页面信息。  </p>
<p>请确保您使用媒体管理器进行了任何屏幕截图修改。您应该在所有语言和所有支持的设备上确认您的应用程序的外观和行为。学习如何使用媒体管理器为每个显示大小和本地化添加自定义屏幕截图。  </p>
<p>由于您的iTunes Connect状态被拒绝，所以我们不需要新的二进制文件。要修改元数据，请访问iTunes Connect，选择您的应用程序并修改所需的元数据值。一旦你完成了所有的变更，在决议中心回复这条信息，我们将继续审查。  </p>
<p>注意:通过选择每个特定的本地化并做出适当的更改，请确保对所有应用程序本地化进行任何元数据更改。  </p>
<h4 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h4><p><a href="https://github.com/quanweiwang/Gank.io" target="_blank" rel="external">https://github.com/quanweiwang/Gank.io</a></p>
<h4 id="App-Store"><a href="#App-Store" class="headerlink" title="App Store"></a>App Store</h4><p>搜索– 今日干货  </p>
<p><a href="https://itunes.apple.com/cn/app/id1353802293?&amp;mt=8" target="_blank" rel="external">https://itunes.apple.com/cn/app/id1353802293?&amp;mt=8</a></p>
<h4 id="感谢所有默默付出的编辑们愿大家有美好一天"><a href="#感谢所有默默付出的编辑们愿大家有美好一天" class="headerlink" title="感谢所有默默付出的编辑们愿大家有美好一天"></a>感谢所有默默付出的编辑们愿大家有美好一天</h4>]]></content>
    
    <summary type="html">
    
      &lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/gank.io-1.png&quot; alt=&quot;gank.io&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;2016年1月11日订阅干货集中营，没翻邮件我自己都忘了。&lt;br&gt;从开始的每天中午一更到现在佛系更新，一路见证了干货集中营的发展历程。&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 简易富文本使用教程</title>
    <link href="http://www.wangquanwei.com/2017-12-26-1.html"/>
    <id>http://www.wangquanwei.com/2017-12-26-1.html</id>
    <published>2017-12-26T03:33:08.000Z</published>
    <updated>2019-01-05T05:34:03.561Z</updated>
    
    <content type="html"><![CDATA[<div align="center"><br><br><img src="https://img.wangquanwei.com/201806011100.png" alt="image"><br><br></div>

<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>本文所使用的第三方富文本工具类由YouXianMing大神提供。<br><a href="https://www.cnblogs.com/YouXianMing/p/3875542.html" target="_blank" rel="external">https://www.cnblogs.com/YouXianMing/p/3875542.html</a></p>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>1、在使用UITextView的富文本时 allowsEditingTextAttributes 必须设为 YES 否则会出现无法改变字体大小的问题，是否存在其他问题待发现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textView.allowsEditingTextAttributes = YES;</div></pre></td></tr></table></figure>
<p>2、iOS10.3开始给文字添加删除线会不起作用，需要添加以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[attributedString addAttributes:@&#123;NSStrikethroughStyleAttributeName:@(NSUnderlineStyleSingle),NSBaselineOffsetAttributeName:@(0)&#125; range:deleteLineRange];</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="可点击的富文本"><a href="#可点击的富文本" class="headerlink" title="可点击的富文本"></a>可点击的富文本</h4><div align="center"><br><br><img src="https://img.wangquanwei.com/01A5C8DE-3514-4C96-9E1B-F1FA10B73E52.png?imageMogr2/thumbnail/!100p" alt="image"><br><br></div>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//协议</div><div class="line">UITextView * protocolTextView = [self protocol];</div><div class="line">[self.view addSubview:protocolTextView];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">####pragma mark- 协议</div><div class="line">- (UITextView *)protocol&#123;</div><div class="line">    </div><div class="line">    UITextView * textView = [[UITextView alloc] init];</div><div class="line">    </div><div class="line">    NSMutableParagraphStyle *ps = [[NSMutableParagraphStyle alloc] init];</div><div class="line">    [ps setAlignment:NSTextAlignmentCenter];</div><div class="line">    </div><div class="line">    NSMutableAttributedString *attributedString = [[NSMutableAttributedString alloc] initWithString:@&quot;注册即表示您已阅读，并同意《服务条款》&quot;];</div><div class="line">    [attributedString addAttribute:NSLinkAttributeName</div><div class="line">                                  value:@&quot;fuwu://&quot;</div><div class="line">                                  range:[[attributedString string] rangeOfString:@&quot;《服务条款》&quot;]];</div><div class="line"></div><div class="line">    [attributedString addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:kHeight(22)] range:NSMakeRange(0, attributedString.length)];</div><div class="line">    [attributedString addAttribute:NSParagraphStyleAttributeName value:ps range:NSMakeRange(0, attributedString.length)];</div><div class="line">    [attributedString addAttribute:NSForegroundColorAttributeName value:RGB_HEX(0x535353) range:NSMakeRange(0, attributedString.length)];</div><div class="line">    </div><div class="line">    textView.attributedText = attributedString;</div><div class="line">    textView.linkTextAttributes = @&#123;NSForegroundColorAttributeName: RGB_HEX(0x89a3d1),</div><div class="line">                                    NSUnderlineColorAttributeName: [UIColor lightGrayColor],</div><div class="line">                                    &#125;;</div><div class="line"></div><div class="line">    textView.delegate = self;</div><div class="line">    textView.editable = NO;        //必须禁止输入，否则点击将弹出输入键盘</div><div class="line">    textView.scrollEnabled = NO;</div><div class="line">    </div><div class="line">    return textView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>点击《服务条款》后就会执行以下方法，前提textView.delegate = self;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (BOOL)textView:(UITextView *)textView shouldInteractWithURL:(NSURL *)URL inRange:(NSRange)characterRange &#123;</div><div class="line">    </div><div class="line">    if ([[URL scheme] isEqualToString:@&quot;fuwu&quot;]) &#123;</div><div class="line">        </div><div class="line">        //服务条款</div><div class="line">        //具体的业务逻辑</div><div class="line">        </div><div class="line">        return NO;</div><div class="line">    &#125; </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="不同的文字颜色"><a href="#不同的文字颜色" class="headerlink" title="不同的文字颜色"></a>不同的文字颜色</h4><div align="center"><br><br><img src="https://img.wangquanwei.com/159F5645-C87D-4834-81EF-0DBA32F02A31.png" alt="image"><br><br></div>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (NSMutableAttributedString *)cashPriceAttributedWithString:(NSString *)price originalPrice:(NSString *)originalPrice &#123;</div><div class="line">    </div><div class="line">    NSString * str = [NSString stringWithFormat:@&quot;凭此券到店支付%@可抵%@&quot;,price,originalPrice];</div><div class="line">    //数字</div><div class="line">    NSRange priceRange = NSMakeRange(7, [price length]);</div><div class="line">    NSRange originalPriceRange = NSMakeRange(7+[price length]+2, [originalPrice length]);</div><div class="line">    </div><div class="line">    NSMutableAttributedString * attributedString = [str createAttributedStringAndConfig:@[</div><div class="line">                                                                                          [ConfigAttributedString foregroundColor:RGB_HEX(0xcbb693) range:priceRange],</div><div class="line">                                                                                          [ConfigAttributedString foregroundColor:RGB_HEX(0xcbb693) range:originalPriceRange],</div><div class="line">                                                                                          ]];</div><div class="line">    return attributedString;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="调整文字位置"><a href="#调整文字位置" class="headerlink" title="调整文字位置"></a>调整文字位置</h4><p><img src="https://img.wangquanwei.com/3101B044-201C-460F-A7EC-2BC328B6027A.png" alt="image"></p>
<p>图中的红点，不是图片是输入法符号里找出来的。<br><strong>可能存在红点不和文字对齐的情况，所以要用到基线偏移 NSBaselineOffsetAttributeName</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (NSMutableAttributedString *)bargainAttributedString:(NSString *)string &#123;</div><div class="line">    </div><div class="line">    NSString * str = [NSString stringWithFormat:@&quot;● %@&quot;,string];</div><div class="line">    NSRange range = NSMakeRange(0, 1);</div><div class="line">    </div><div class="line">    NSMutableAttributedString * attributedString = [str createAttributedStringAndConfig:@[</div><div class="line">                                                                                          [ConfigAttributedString foregroundColor:RGB_HEX(0xCC5354) range:range],</div><div class="line">                                                                                          [ConfigAttributedString font:[UIFont boldSystemFontOfSize:6.f] range:range],</div><div class="line">                                                                                          </div><div class="line">                                                                                          ]];</div><div class="line">    //NSBaselineOffsetAttributeName 设置基线偏移值。取值为NSNumber （float），正值上偏，负值下偏</div><div class="line">    [attributedString addAttribute:NSBaselineOffsetAttributeName value:@(3) range:[str rangeOfString:@&quot;●&quot;]];</div><div class="line">    </div><div class="line">    return attributedString;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="文字不同大小"><a href="#文字不同大小" class="headerlink" title="文字不同大小"></a>文字不同大小</h4><div align="center"> 

<p><img src="https://img.wangquanwei.com/BD3DE029-754F-444D-9738-A4235D4C5304.png" alt="image"></p>
<p></p></div><br>图中左边¥和右边100大小不一样<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">//string = ¥100</div><div class="line">- (NSMutableAttributedString *)priceAttributedString:(NSString *)string &#123;</div><div class="line">    </div><div class="line">    //优惠价</div><div class="line">    NSRange vipPriceRange = NSMakeRange(1, [string length]-1);</div><div class="line">    NSMutableAttributedString * attributedString = [string createAttributedStringAndConfig:@[</div><div class="line">                                                                                             [ConfigAttributedString font:[UIFont systemFontOfSize:42.f] range:vipPriceRange],</div><div class="line">                                                                                             ]];</div><div class="line">    return attributedString;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="文字删除线"><a href="#文字删除线" class="headerlink" title="文字删除线"></a>文字删除线</h4><div align="center"> 

<p><img src="https://img.wangquanwei.com/BD3DE029-754F-444D-9738-A4235D4C5304.png" alt="image"></p>
<p></p></div><br>图中右下角原优惠价150带删除线<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (NSMutableAttributedString *)originalAttributedString:(NSString *)string &#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    //删除线</div><div class="line">    NSRange deleteLineRange = NSMakeRange(0, [string length]);</div><div class="line"></div><div class="line">    NSMutableAttributedString * attributedString = [string createAttributedStringAndConfig:@[</div><div class="line">                                                                                                [ConfigAttributedString strikethroughStyle:NSUnderlineStyleSingle range:deleteLineRange],</div><div class="line"></div><div class="line">                                                                                             ]];</div><div class="line"></div><div class="line">    [attributedString addAttributes:@&#123;NSStrikethroughStyleAttributeName:@(NSUnderlineStyleSingle),NSBaselineOffsetAttributeName:@(0)&#125; range:deleteLineRange];</div><div class="line">    </div><div class="line">    return attributedString;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;div align=center&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;https://img.wangquanwei.com/201806011100.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;

&lt;h4 id=&quot;Overview&quot;&gt;&lt;a href=&quot;#Overview&quot; class=&quot;headerlink&quot; title=&quot;Overview&quot;&gt;&lt;/a&gt;Overview&lt;/h4&gt;&lt;p&gt;本文所使用的第三方富文本工具类由YouXianMing大神提供。&lt;br&gt;&lt;a href=&quot;https://www.cnblogs.com/YouXianMing/p/3875542.html&quot;&gt;https://www.cnblogs.com/YouXianMing/p/3875542.html&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;注意事项&quot;&gt;&lt;a href=&quot;#注意事项&quot; class=&quot;headerlink&quot; title=&quot;注意事项&quot;&gt;&lt;/a&gt;注意事项&lt;/h4&gt;&lt;p&gt;1、在使用UITextView的富文本时 allowsEditingTextAttributes 必须设为 YES 否则会出现无法改变字体大小的问题，是否存在其他问题待发现。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;textView.allowsEditingTextAttributes = YES;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2、iOS10.3开始给文字添加删除线会不起作用，需要添加以下代码&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;[attributedString addAttributes:@&amp;#123;NSStrikethroughStyleAttributeName:@(NSUnderlineStyleSingle),NSBaselineOffsetAttributeName:@(0)&amp;#125; range:deleteLineRange];&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>mac 10.13 cocoapods无法使用的解决办法</title>
    <link href="http://www.wangquanwei.com/2017-10-09-1.html"/>
    <id>http://www.wangquanwei.com/2017-10-09-1.html</id>
    <published>2017-10-09T07:13:08.000Z</published>
    <updated>2019-01-05T05:55:11.998Z</updated>
    
    <content type="html"><![CDATA[<h4 id="syntax-error-unexpected-end-of-file"><a href="#syntax-error-unexpected-end-of-file" class="headerlink" title="syntax error: unexpected end of file"></a>syntax error: unexpected end of file</h4><p><img src="https://img.wangquanwei.com/cocoapods%2010.13%20%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8.png" alt="image"><br><a id="more"></a></p>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//我开了科学上网</div><div class="line">sudo gem install cocoapods</div></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods --pre</div></pre></td></tr></table></figure>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://github.com/CocoaPods/CocoaPods/issues/6778" target="_blank" rel="external">https://github.com/CocoaPods/CocoaPods/issues/6778</a></p>
<p><a href="https://stackoverflow.com/questions/44396215/cocoapods-not-working-in-macos-high-sierra" target="_blank" rel="external">https://stackoverflow.com/questions/44396215/cocoapods-not-working-in-macos-high-sierra</a></p>
<h4 id="ERROR-While-executing-gem-…-TypeError-no-implicit-conversion-of-nil-into-String"><a href="#ERROR-While-executing-gem-…-TypeError-no-implicit-conversion-of-nil-into-String" class="headerlink" title="ERROR:  While executing gem … (TypeError) no implicit conversion of nil into String"></a>ERROR:  While executing gem … (TypeError) no implicit conversion of nil into String</h4><p>这是在执行install cocoapods时报的错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ERROR:  While executing gem ... (TypeError)</div><div class="line">    no implicit conversion of nil into String</div></pre></td></tr></table></figure>
<h4 id="解决办法-1"><a href="#解决办法-1" class="headerlink" title="解决办法"></a>解决办法</h4><p>先执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem update -n /usr/local/bin --system</div></pre></td></tr></table></figure>
<p>再执行：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install -n /usr/local/bin cocoapods --pre</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;syntax-error-unexpected-end-of-file&quot;&gt;&lt;a href=&quot;#syntax-error-unexpected-end-of-file&quot; class=&quot;headerlink&quot; title=&quot;syntax error: unexpected end of file&quot;&gt;&lt;/a&gt;syntax error: unexpected end of file&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;https://img.wangquanwei.com/cocoapods%2010.13%20%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 轻量级社会化组件Trochilus使用指北</title>
    <link href="http://www.wangquanwei.com/2017-07-24-1.html"/>
    <id>http://www.wangquanwei.com/2017-07-24-1.html</id>
    <published>2017-07-24T15:07:08.000Z</published>
    <updated>2019-01-05T05:56:09.437Z</updated>
    
    <content type="html"><![CDATA[<h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>Trochilus是iOS轻量级社会化组件(支持:免SDK支付、打赏、分享、授权)。  </p>
<p>现已支持以下平台:    </p>
<p>QQ (QQ好友分享、QQ空间分享、QQ授权)<br>微信 (微信好友分享、微信朋友圈分享、微信收藏、小程序分享、微信授权、微信支付)<br>微博 (微博分享、微博授权)<br>支付宝 (支付宝支付、支付宝打赏)</p>
<a id="more"></a>
<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><p>1、无需导入以下系统库(framework、tbd)</p>
<p>QQ平台  </p>
<p><del>libiconv.dylib<br>SystemConfiguration.framework<br>CoreGraphics.Framework<br>libsqlite3.dylib<br>CoreTelephony.framework<br>libstdc++.dylib<br>libz.dylib</del></p>
<p>微信平台  </p>
<p><del>SystemConfiguration.framework<br>libz.dylib<br>libsqlite3.0.dylib<br>libc++.dylib<br>Security.framework<br>CoreTelephony.framework<br>CFNetwork.framework</del></p>
<p>微博平台  </p>
<p><del>ImageIO.framework<br>libsqlite3.dylib</del>  </p>
<p>支付宝平台  </p>
<p><del>CFNetwork.framework<br>SystemConfiguration.framework<br>CoreGraphics.framework<br>CoreMotion.framework<br>CoreTelephony.framework<br>CoreText.framework<br>libc++.tbd<br>libz.tbd</del>  </p>
<p>2、无需导入各个平台SDK  </p>
<p><del>QQSDK<br>微信SDK<br>微博SDK<br>支付宝SDK</del></p>
<p>3、各个平台回调Trochilus内部自动处理。  </p>
<p>4、解决iOS9 or latter左上角返回，不触发回调的问题。  </p>
<h4 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h4><ul>
<li>[ ] 必填参数验证(当必填参数未填时返回错误信息)</li>
<li>[ ] CocoaPods支持</li>
<li>[ ] 日志系统</li>
</ul>
<h4 id="快速使用"><a href="#快速使用" class="headerlink" title="快速使用"></a>快速使用</h4><p>打开AppDelegate.m导入头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;Trochilus/Trochilus.h&gt;</div></pre></td></tr></table></figure>
<p>在- (BOOL)application: didFinishLaunchingWithOptions:方法中调用registerPlatforms方法来初始化第三方平台</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</div><div class="line">    // Override point for customization after application launch.</div><div class="line">    </div><div class="line">    NSArray * platforms = @[</div><div class="line">                            @(TrochilusPlatformTypeSinaWeibo),</div><div class="line">                            @(TrochilusPlatformTypeQQ),</div><div class="line">                            @(TrochilusPlatformTypeWechat)</div><div class="line">                            ];</div><div class="line">    </div><div class="line">    [Trochilus registerPlatforms:platforms onConfiguration:^(TrochilusPlatformType platformType, NSMutableDictionary *appInfo) &#123;</div><div class="line">        </div><div class="line">        switch (platformType) &#123;</div><div class="line">            case TrochilusPlatformTypeSinaWeibo:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetSinaWeiboByAppKey:kSinaWeiboAppKey</div><div class="line">                                             appSecret:kSinaWeiboAppSecret</div><div class="line">                                           redirectUri:kSinaWeiboRedirectUri];</div><div class="line">                </div><div class="line">                break;</div><div class="line">            case TrochilusPlatformTypeQQ:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetQQByAppId:kQQAppId</div><div class="line">                                        appKey:kQQAppKey</div><div class="line">                                        useTIM:NO];</div><div class="line">                break;</div><div class="line">            case TrochilusPlatformTypeWechat:</div><div class="line">                </div><div class="line">                [appInfo trochilusSetWeChatByAppId:kWeChatAppId</div><div class="line">                                         appSecret:kWeChatAppSecret];</div><div class="line">                </div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>(注意：每一个case对应一个break不要忘记填写，不然很可能有不必要的错误。）</p>
<h4 id="分享"><a href="#分享" class="headerlink" title="分享"></a>分享</h4><p>添加以下代码，分享之后的效果需要去对应的分享平台上观看，首先要构造分享参数，然后再根据每个平台的方法定制自己想要分享的不同的分享内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">NSMutableDictionary * parameters = [NSMutableDictionary dictionary];</div><div class="line"></div><div class="line">//QQ好友分享</div><div class="line">[parameters trochilusSetQQParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                 title:nil</div><div class="line">                                   url:nil</div><div class="line">                         audioFlashURL:nil</div><div class="line">                         videoFlashURL:nil</div><div class="line">                            thumbImage:nil</div><div class="line">                                images:nil</div><div class="line">                                  type:self.type];</div><div class="line">                           </div><div class="line">//微信好友分享</div><div class="line">[parameters trochilusSetWeChatParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                     title:nil</div><div class="line">                                       url:nil</div><div class="line">                              mediaTagName:nil</div><div class="line">                             messageAction:nil</div><div class="line">                                thumbImage:nil</div><div class="line">                                     image:nil</div><div class="line">                              musicFileURL:nil</div><div class="line">                                   extInfo:nil</div><div class="line">                                  fileData:nil</div><div class="line">                             fileExtension:nil</div><div class="line">                              emoticonData:nil</div><div class="line">                                      type:TrochilusContentTypeText];</div><div class="line"></div><div class="line">//微信小程序分享</div><div class="line">[parameters trochilusSetWeChatMiniProgramShareParamsByWebpageUrl:@&quot;http://www.wangquanwei.com/&quot;</div><div class="line">                                                        userName:@&quot;gh_d43f693ca31f&quot;</div><div class="line">                                                            path:@&quot;/page/API/pages/share/share&quot;</div><div class="line">                                                           title:@&quot;MiniProgram&quot;</div><div class="line">                                                     description:@&quot;test MiniProgram&quot;</div><div class="line">                                                      thumbImage:thumbImage</div><div class="line">                                                     hdThumImage:thumbImage</div><div class="line">                                                 withShareTicket:YES</div><div class="line">                                                     contentType:TrochilusContentTypeMiniProgram</div><div class="line">                                                 miniProgramType:TrochilusMiniProgramTypeRelease];</div><div class="line"></div><div class="line">//微博分享</div><div class="line">[parameters trochilusSetSinaWeiboShareParamsByText:@&quot;Trochilus&quot;</div><div class="line">                                             title:nil</div><div class="line">                                             image:nil</div><div class="line">                                               url:nil</div><div class="line">                                          latitude:0</div><div class="line">                                         longitude:0</div><div class="line">                                          objectID:nil</div><div class="line">                                              type:TrochilusContentTypeText];</div><div class="line">//分享</div><div class="line">[Trochilus shareWithPlatformType:&#123;分享平台&#125; parameters:parameters onStateChanged:^(TrochilusResponseState state, NSDictionary *userData, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;分享成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;分享失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>更多可以参考文件 (Trochilus / Category / NSMutableDictionary+TrochilusShare)中的方法。</p>
<h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p>把如下代码复制并粘贴到你要登录的位置,并且修改相应的参数即可。<br>这里以QQ登陆为例<br>（其他的平台也一样的处理，修改下登陆方法里authorize的平台类型参数：微信登录－&gt; TrochilusPlatformTypeWechat,新浪微博登录－&gt;TrochilusPlatformTypeSinaWeibo。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">[Trochilus authorizeWithPlatformType:TrochilusPlatformTypeQQ settings:nil onStateChanged:^(TrochilusResponseState state, TrochilusUser *user, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;授权成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;授权失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h4 id="支付"><a href="#支付" class="headerlink" title="支付"></a>支付</h4><p>首先要构造支付参数，然后再根据每个平台调用不同的方法。<br>支付涉及到敏感数据，参数全隐去。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">//微信支付</div><div class="line">NSMutableDictionary * wechatPay = [NSMutableDictionary dictionary];</div><div class="line">[wechatPay payWithWechatPartnerId:&#123;partnerId&#125;</div><div class="line">                             prepayId:&#123;prepayId&#125;</div><div class="line">                             nonceStr:&#123;nonceStr&#125;</div><div class="line">                            timeStamp:@&quot;1499752264&quot;</div><div class="line">                              package:@&quot;Sign=WXPay&quot; //iOS微信支付package只能为Sign=WXPay</div><div class="line">                                 sign:&#123;sign&#125;];</div><div class="line">                                 </div><div class="line">[Trochilus wechatPayWithParameters:wechatPay onStateChanged:^(TrochilusResponseState state,NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;支付成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;支付失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStatePayWait: &#123;</div><div class="line">                </div><div class="line">                //iOS9 or later 左上角返回app时 返回TrochilusResponseStatePayWait状态，客户端需要自己去服务器查询是否支付成功</div><div class="line">                </div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">//支付宝支付</div><div class="line">NSString * urlScheme = &#123;urlScheme&#125;;</div><div class="line">NSString * orderString = &#123;由服务器返回构造好的支付字符串&#125;;</div><div class="line"></div><div class="line">[Trochilus aliPayWithUrlScheme:urlScheme orderString:orderString onStateChanged:^(TrochilusResponseState state, NSError *error) &#123;</div><div class="line">        </div><div class="line">        switch (state) &#123;</div><div class="line">            case TrochilusResponseStateSuccess: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;支付成功&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateFail: &#123;</div><div class="line">                </div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:[NSString stringWithFormat:@&quot;支付失败\n%@&quot;,error] delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStateCancel: &#123;</div><div class="line">                UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@&quot;提示&quot; message:@&quot;用户取消&quot; delegate:nil cancelButtonTitle:@&quot;确定&quot; otherButtonTitles:nil, nil];</div><div class="line">                [alert show];</div><div class="line">            &#125;</div><div class="line">                break;</div><div class="line">            case TrochilusResponseStatePayWait: &#123;</div><div class="line">                </div><div class="line">                //iOS9 or later 左上角返回app时 返回TrochilusResponseStatePayWait状态，客户端需要自己去服务器查询是否支付成功</div><div class="line">                </div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            default:</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h4 id="适配iOS9-系统"><a href="#适配iOS9-系统" class="headerlink" title="适配iOS9+系统"></a>适配iOS9+系统</h4><p>1、http 问题:<br>在iOS9下，系统默认会拦截对http协议接口的访问，因此无法获取http协议接口的数据。对Trochilus来说，可能无法获取用户信息。<br>解决方法:<br>在项目的info.plist中添加一个Key：App Transport Security Settings，类型为字典类型。然后给它添加一个Key：Allow Arbitrary Loads，类型为Boolean类型，值为YES。</p>
<p><img src="https://img.wangquanwei.com/Trochilus1.png" alt="">  </p>
<p>2、白名单 问题：<br>在iOS 9下涉及到平台客户端跳转，系统会自动到项目info.plist下检测是否设置平台Scheme。对于需要配置的平台，如果没有配置，就无法正常跳转平台客户端。因此要支持客户端的分享和授权等，需要配置Scheme名单。<br>解决方法:<br>在项目的info.plist中添加一LSApplicationQueriesSchemes，类型为Array。然后给它添加一个需要支持的项目，类型为字符串类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">	&lt;string&gt;wechat&lt;/string&gt;</div><div class="line">	&lt;string&gt;weixin&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibohd&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibo&lt;/string&gt;</div><div class="line">	&lt;string&gt;sinaweibosso&lt;/string&gt;</div><div class="line">	&lt;string&gt;weibosdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;weibosdk2.5&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqq&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqOpensdkSSoLogin&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqconnect&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkdataline&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkgrouptribeshare&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkfriend&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapiV2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqopensdkapiV3&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginmqq&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginmqq2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqqwpa&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzone&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzonev2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneshare&lt;/string&gt;</div><div class="line">	&lt;string&gt;wtloginqzone&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzonewx&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapiV2&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapi19&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdkapi&lt;/string&gt;</div><div class="line">	&lt;string&gt;mqzoneopensdk&lt;/string&gt;</div><div class="line">	&lt;string&gt;alipay&lt;/string&gt;</div><div class="line">	&lt;string&gt;alipayshare&lt;/string&gt;</div><div class="line">&lt;/array&gt;</div></pre></td></tr></table></figure>
<p><img src="https://img.wangquanwei.com/Trochilus2.png" alt=""></p>
<h4 id="URL-Scheme"><a href="#URL-Scheme" class="headerlink" title="URL Scheme"></a>URL Scheme</h4><p>别忘了配置URL Scheme否则将无法返回客户端。<br>具体规则请看各个平台文档。</p>
<h4 id="Support-or-Contact"><a href="#Support-or-Contact" class="headerlink" title="Support or Contact"></a>Support or Contact</h4><p>在使用Trochilus过程中有任何问题，都可以添加一个<a href="https://github.com/quanweiwang/Trochilus/issues" target="_blank" rel="external">issues</a>，我会及时解决。如果您想贡献代码，欢迎Pull Requests。</p>
<h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p><a href="https://github.com/quanweiwang/Trochilus" target="_blank" rel="external">Trochilus https://github.com/quanweiwang/Trochilus</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h4&gt;&lt;p&gt;Trochilus是iOS轻量级社会化组件(支持:免SDK支付、打赏、分享、授权)。  &lt;/p&gt;
&lt;p&gt;现已支持以下平台:    &lt;/p&gt;
&lt;p&gt;QQ (QQ好友分享、QQ空间分享、QQ授权)&lt;br&gt;微信 (微信好友分享、微信朋友圈分享、微信收藏、小程序分享、微信授权、微信支付)&lt;br&gt;微博 (微博分享、微博授权)&lt;br&gt;支付宝 (支付宝支付、支付宝打赏)&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>mac 安装 protocol buffer（2.6.1版） 教程</title>
    <link href="http://www.wangquanwei.com/2017-06-10-1.html"/>
    <id>http://www.wangquanwei.com/2017-06-10-1.html</id>
    <published>2017-06-10T12:23:22.000Z</published>
    <updated>2019-01-05T05:57:31.847Z</updated>
    
    <content type="html"><![CDATA[<p>在写这篇文章时protocol buffer的最新版为3.3.1。</p>
<h4 id="什么是protocol-buffer"><a href="#什么是protocol-buffer" class="headerlink" title="什么是protocol buffer"></a>什么是protocol buffer</h4><blockquote>
<p>protocol buffer(以下简称PB)是google 的一种数据交换的格式，它独立于语言，独立于平台。google 提供了多种语言的实现：java、c####、c++、go 和 python，每一种实现都包含了相应语言的编译器以及库文件。由于它是一种二进制的格式，比使用 xml 进行数据交换快许多。可以把它用于分布式应用之间的数据通信或者异构环境下的数据交换。作为一种效率和兼容性都很优秀的二进制数据传输格式，可以用于诸如网络传输、配置文件、数据存储等诸多领域。<br>以上内容来自百度百科。</p>
</blockquote>
<a id="more"></a>
<h4 id="安装-brew"><a href="#安装-brew" class="headerlink" title="安装 brew"></a>安装 brew</h4><p>打开终端，输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>
<p>回车,会提示按任意键继续，继续会出现输入密码的提示，输入电脑的密码即可继续安装。</p>
<h4 id="安装-automake"><a href="#安装-automake" class="headerlink" title="安装 automake"></a>安装 automake</h4><p>终端输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install automake</div></pre></td></tr></table></figure>
<h4 id="安装-libtool"><a href="#安装-libtool" class="headerlink" title="安装 libtool"></a>安装 libtool</h4><p>终端输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install libtool</div></pre></td></tr></table></figure>
<h4 id="安装-protobuf"><a href="#安装-protobuf" class="headerlink" title="安装 protobuf"></a>安装 protobuf</h4><p>这里主讲方式二安装  </p>
<p>方式一、<br>终端输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install protobuf</div></pre></td></tr></table></figure>
<p>方式二、  </p>
<p>1、下载protobuf：<a href="https://github.com/google/protobuf" target="_blank" rel="external">https://github.com/google/protobuf</a>    </p>
<p>2、解压下载的protobuf，并打开终端cd到protobuf目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /你的存放路径/protobuf-2.6.1</div></pre></td></tr></table></figure>
<p><img src="https://img.wangquanwei.com/mac%20%E5%AE%89%E8%A3%85%20protocol%20buffer%EF%BC%882.6.1%E7%89%88%EF%BC%89%20%E6%95%99%E7%A8%8B1.png" alt="image"></p>
<p>3、执行autogen.sh脚本  </p>
<p>如果按照网上大多数教程，那是执行./configure了，但是你会发现根目录下根本没有configure文件，因为protobuf的编译方式做了修改，要执行autogen.sh才会生成configure脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./autogen.sh</div></pre></td></tr></table></figure>
<p>敲黑板！！！    </p>
<p>这里有个坑,你会发现即使你科学上网了还是time out载不下来。  </p>
<p><img src="https://img.wangquanwei.com/mac%20%E5%AE%89%E8%A3%85%20protocol%20buffer%EF%BC%882.6.1%E7%89%88%EF%BC%89%20%E6%95%99%E7%A8%8B2.png" alt="image"></p>
<p>我们打开autogen.sh脚本看看  </p>
<p><img src="https://img.wangquanwei.com/mac%20%E5%AE%89%E8%A3%85%20protocol%20buffer%EF%BC%882.6.1%E7%89%88%EF%BC%89%20%E6%95%99%E7%A8%8B3.png" alt="image"></p>
<p>看到木有，autogen.sh会去下载一个叫gtest的东东，我们打开其URL看看，404啊有木有！！！  </p>
<p><a href="http://googletest.googlecode.com/files/gtest-1.5.0.tar.bz2" target="_blank" rel="external">http://googletest.googlecode.com/files/gtest-1.5.0.tar.bz2</a></p>
<p>4、下载gtest-1.5.0  </p>
<p><a href="https://github.com/google/googletest/tree/release-1.5.0" target="_blank" rel="external">https://github.com/google/googletest/tree/release-1.5.0</a></p>
<p>下载完成后解压并把文件夹名字改成gtest，并且复制到protobuf文件夹里。</p>
<p><img src="https://img.wangquanwei.com/mac%20%E5%AE%89%E8%A3%85%20protocol%20buffer%EF%BC%882.6.1%E7%89%88%EF%BC%89%20%E6%95%99%E7%A8%8B4.png" alt="image"></p>
<p>5、重复第三步  </p>
<p>因为本地已经有了gtest所以就不会去下载了  </p>
<p>执行autogen.sh脚本并生成configure</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./autogen.sh</div></pre></td></tr></table></figure>
<p>6、执行configure<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./configure</div></pre></td></tr></table></figure></p>
<p>7、编译protobuf</p>
<p>按从上到下顺序依次执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make check</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo make install</div></pre></td></tr></table></figure>
<p>8、检测是否安装成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">protoc --version</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在写这篇文章时protocol buffer的最新版为3.3.1。&lt;/p&gt;
&lt;h4 id=&quot;什么是protocol-buffer&quot;&gt;&lt;a href=&quot;#什么是protocol-buffer&quot; class=&quot;headerlink&quot; title=&quot;什么是protocol buffer&quot;&gt;&lt;/a&gt;什么是protocol buffer&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;protocol buffer(以下简称PB)是google 的一种数据交换的格式，它独立于语言，独立于平台。google 提供了多种语言的实现：java、c####、c++、go 和 python，每一种实现都包含了相应语言的编译器以及库文件。由于它是一种二进制的格式，比使用 xml 进行数据交换快许多。可以把它用于分布式应用之间的数据通信或者异构环境下的数据交换。作为一种效率和兼容性都很优秀的二进制数据传输格式，可以用于诸如网络传输、配置文件、数据存储等诸多领域。&lt;br&gt;以上内容来自百度百科。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="ProtocolBuffer" scheme="http://www.wangquanwei.com/categories/ProtocolBuffer/"/>
    
    
  </entry>
  
  <entry>
    <title>开启iOS自带的调试悬浮窗UIDebuggingInformationOverlay</title>
    <link href="http://www.wangquanwei.com/2017-06-03-1.html"/>
    <id>http://www.wangquanwei.com/2017-06-03-1.html</id>
    <published>2017-06-03T02:24:21.000Z</published>
    <updated>2019-01-05T05:58:23.814Z</updated>
    
    <content type="html"><![CDATA[<h4 id="什么是UIDebuggingInformationOverlay"><a href="#什么是UIDebuggingInformationOverlay" class="headerlink" title="什么是UIDebuggingInformationOverlay"></a>什么是UIDebuggingInformationOverlay</h4><p>UIDebuggingInformationOverlay是由苹果创建的私有子类，大概是帮助开发人员和设计师调试苹果自己的iOS应用程序。</p>
<p>启用后，窗口会浮动在应用的内容上，如下所示</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1488825-279074db866c0051.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<a id="more"></a>
<h4 id="如何开启UIDebuggingInformationOverlay"><a href="#如何开启UIDebuggingInformationOverlay" class="headerlink" title="如何开启UIDebuggingInformationOverlay"></a>如何开启UIDebuggingInformationOverlay</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#123;</div><div class="line">    // Override point for customization after application launch.</div><div class="line"></div><div class="line">    Class overlayClass = NSClassFromString(@&quot;UIDebuggingInformationOverlay&quot;);</div><div class="line">    [[overlayClass class] performSelector:@selector(prepareDebuggingOverlay)];</div><div class="line"></div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>开启后使用两根手指点击状态栏来调出调试面板。<br>PS:该类是私有类，因此可能将无法通过App Store审核。</p>
<h4 id="UIDebuggingInformationOverlay可以做什么"><a href="#UIDebuggingInformationOverlay可以做什么" class="headerlink" title="UIDebuggingInformationOverlay可以做什么"></a>UIDebuggingInformationOverlay可以做什么</h4><p>从屏幕截图可以看出，覆盖层提供了六个功能。本文将对前五个进行介绍。</p>
<p>一、View Hierarchy<br>这个选项可以向你展示当前选择的窗口的视图列表。可通过点击cell右侧的感叹号查看详情。包括视图的frame和成员变量等。<br><img src="http://upload-images.jianshu.io/upload_images/1210359-9823a941c7bc9c33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"><br><img src="http://upload-images.jianshu.io/upload_images/1210359-bc74b8cfbf8086e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<p>二、VC Hierarchy<br>通过这个可以大致看到ViewController层次结构。它与“View Hierarchy”非常相似，只是它显示了活动视图控制器的层次结构。从这里，你可以检查任何视图控制器的详情，包括其视图。<br><img src="http://upload-images.jianshu.io/upload_images/1210359-7bb08a7735cde2b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<p>三、Ivar Explorer<br>这个特性允许你查看UIApplication对象的成员变量。更重要的是，任何一个对象的变量都是可以被查看的。<br>这包括app delegate，根据你的应用程序的结构，可能会提供一个很好的切入点，允许你进入自定义的对象里。<br><img src="http://upload-images.jianshu.io/upload_images/1210359-0b736ab1044c5eeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<p>四、Measure<br>在我看来，这是一个比较酷的特性。它允许你以pt这个精度去测量屏幕内各个元素的尺寸。首先，选择你想查看水平还是竖直的轴线。然后手指拖动屏幕，使用控制台内的放大器来帮助你。有两种模式:</p>
<p>默认的模式忽略了视图边界。据我所知,这种模式将屏幕作为一个点阵图片,并通过颜色的变化作为潜在的测量边界。例如,在下面的屏幕截图中,我能够测量一个textfield的文字的边界和屏幕边界的距离:<br><img src="http://upload-images.jianshu.io/upload_images/1210359-eda3e4204238ee3f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<p>“View Mode”则是另外一种处理方式。它清晰的展示了每一个子视图的尺寸。拖动你的手指到要查看的视图上，可以查看它在你选择的轴线上的范围。在下面的屏幕截图里，我测量了顶部输入框的高度。<br><img src="http://upload-images.jianshu.io/upload_images/1210359-ad07ed6f80fb69a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<p>五、Spec Compare<br>我认为这个工具在开发者与设计师之间提供了极大的便利。添加一个屏幕截图到你的设备里然后通过Spec Compare选择它，被选择的这张屏幕截图会展示在当前app的顶部。你可以在屏幕上拖动来调整透明度，以此来对比设计和你app中的实现具体的不同。</p>
<p>PS：iOS10系统记得添加相册访问权限NSPhotoLibraryUsageDescription，否则将会crash。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1210359-6eb68cbc90b1abac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"><br><img src="http://upload-images.jianshu.io/upload_images/1210359-1a1439d885a31255.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320" alt="image"></p>
<h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><p><a href="https://github.com/quanweiwang/QWDebuggingInformationOverlay" target="_blank" rel="external">QWDebuggingInformationOverlay</a></p>
<p>本文是基于下述原文进行了机器翻译并有增改，侵删！</p>
<p>原文：<a href="http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/" target="_blank" rel="external">http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/</a></p>
<p>图片素材来自<br>简书：<a href="http://www.jianshu.com/u/abdec57edfa1" target="_blank" rel="external">郭大猿</a> 的 <a href="http://www.jianshu.com/p/0efafc9cdd7f" target="_blank" rel="external">http://www.jianshu.com/p/0efafc9cdd7f</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;什么是UIDebuggingInformationOverlay&quot;&gt;&lt;a href=&quot;#什么是UIDebuggingInformationOverlay&quot; class=&quot;headerlink&quot; title=&quot;什么是UIDebuggingInformationOverlay&quot;&gt;&lt;/a&gt;什么是UIDebuggingInformationOverlay&lt;/h4&gt;&lt;p&gt;UIDebuggingInformationOverlay是由苹果创建的私有子类，大概是帮助开发人员和设计师调试苹果自己的iOS应用程序。&lt;/p&gt;
&lt;p&gt;启用后，窗口会浮动在应用的内容上，如下所示&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1488825-279074db866c0051.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;image&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 同一应用设置不同图标和名称</title>
    <link href="http://www.wangquanwei.com/2017-04-27-1.html"/>
    <id>http://www.wangquanwei.com/2017-04-27-1.html</id>
    <published>2017-04-27T13:35:21.000Z</published>
    <updated>2019-01-05T05:34:31.129Z</updated>
    
    <content type="html"><![CDATA[<p>参考资料：曾静的技术博客 <a href="http://blog.devzeng.com/blog/ios-two-version-app-setting-profile.html" target="_blank" rel="external">iOS开发之同一应用设置不同图标和名称</a></p>
<p>我们在开发中经常会遇到一个APP存在多个渠道版本，例如：debug版、App Store提交版、test试版、299$企业版、ipad版等。他们之间可能会存在不同的名字及不同的应用图标，bundle id。</p>
<h4 id="Bundle-id"><a href="#Bundle-id" class="headerlink" title="Bundle id"></a>Bundle id</h4><p>Bundle id 是iOS用来识别app是否相同的依据，因此Bundle id 全球唯一不可重复，因此我们需要打包多渠道版本就需要多个不同的Bundle id。<br><a id="more"></a></p>
<h4 id="Build-Configuration"><a href="#Build-Configuration" class="headerlink" title="Build Configuration"></a>Build Configuration</h4><p>Build Configuration XCode 默认会提供两个即Debug、Release。如下图所示<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E4%BA%8C.png" alt="image"></p>
<p>然鹅！默认的并不满足我们的需求，因此我们需要手动添加一个或者多个新配置项。<br>选中PROJECT的名称，然后选中Info，点击Configurations下面的+选择Duplicate “Debug” Configuration,如下图：<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E4%B8%80.png" alt="image"></p>
<p>可根据需求选择Debug or Release，如果选择Debug会在列表出现Debug Copy的行，如果选择Release会在列表出现Release copy的行，将我们新建的改成自己想要的名字即可。如下图就是将新建的改成AppStore。<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E4%B8%89.png" alt="image"></p>
<h4 id="User-Defined-Setting"><a href="#User-Defined-Setting" class="headerlink" title="User-Defined Setting"></a>User-Defined Setting</h4><blockquote>
<p>以下文字引用自曾静的技术博客 <a href="http://blog.devzeng.com/blog/ios-two-version-app-setting-profile.html" target="_blank" rel="external">iOS开发之同一应用设置不同图标和名称</a> 侵删</p>
<p>在Xcode中使用User-Defined Setting可以定义一些Xcode编译使用的宏配置，为了实现不同环境下App显示的名称和图标不同，可以在User-Defined Setting中定义一些有关应用程序名称和应用图标的配置。</p>
</blockquote>
<p>1、开启User-Defined Setting，如下图：<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E5%9B%9B.png" alt="image"></p>
<p>2、添加APP_DISPLAY_NAME(APP的名称)、APP_ICON_NAME(APP图标名称)和BUNDLE_IDENTIFIER（APP Bundle ID）三个配置选项，效果如下图：<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E4%BA%94.png" alt="image"></p>
<h4 id="配置应用图标"><a href="#配置应用图标" class="headerlink" title="配置应用图标"></a>配置应用图标</h4><p>1、配置应用图标</p>
<p>搜索Asset Catalog Compiler<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E5%85%AD.png" alt="image"></p>
<p>应用图标如图<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E5%85%AB.png" alt="image"></p>
<h4 id="配置应用名称"><a href="#配置应用名称" class="headerlink" title="配置应用名称"></a>配置应用名称</h4><p>1、配置应用名称<br><img src="https://img.wangquanwei.com/iOS%20%E5%90%8C%E4%B8%80%E5%BA%94%E7%94%A8%E8%AE%BE%E7%BD%AE%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87%E5%92%8C%E5%90%8D%E7%A7%B0%E5%9B%BE%E4%B8%83.png" alt="image"></p>
<h4 id="Demo地址"><a href="#Demo地址" class="headerlink" title="Demo地址"></a>Demo地址</h4><p><a href="https://github.com/quanweiwang/iOS-development-set-different-icon-and-name-of-the-same-application" target="_blank" rel="external">iOS开发之同一应用设置不同图标和名称</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;参考资料：曾静的技术博客 &lt;a href=&quot;http://blog.devzeng.com/blog/ios-two-version-app-setting-profile.html&quot;&gt;iOS开发之同一应用设置不同图标和名称&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我们在开发中经常会遇到一个APP存在多个渠道版本，例如：debug版、App Store提交版、test试版、299$企业版、ipad版等。他们之间可能会存在不同的名字及不同的应用图标，bundle id。&lt;/p&gt;
&lt;h4 id=&quot;Bundle-id&quot;&gt;&lt;a href=&quot;#Bundle-id&quot; class=&quot;headerlink&quot; title=&quot;Bundle id&quot;&gt;&lt;/a&gt;Bundle id&lt;/h4&gt;&lt;p&gt;Bundle id 是iOS用来识别app是否相同的依据，因此Bundle id 全球唯一不可重复，因此我们需要打包多渠道版本就需要多个不同的Bundle id。&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 处理JSON字符串里的特殊字符</title>
    <link href="http://www.wangquanwei.com/2017-03-14-1.html"/>
    <id>http://www.wangquanwei.com/2017-03-14-1.html</id>
    <published>2017-03-14T14:38:19.000Z</published>
    <updated>2019-01-05T05:35:02.977Z</updated>
    
    <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>今天遇到一个问题，本地将一个对象转成JSON字符串后传给后台，由于出现特殊字符&amp;导致后台无法正确处理该字符串。经过一番Google，现将问题及解决方法记录如下。</p>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>附上stackoverflow地址 <a href="http://stackoverflow.com/questions/24551816/swift-encode-url" target="_blank" rel="external">http://stackoverflow.com/questions/24551816/swift-encode-url</a></p>
<p>附上常用字符集的解释 注释部分是对应的处理特殊字符的内容<br><a id="more"></a><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">URLFragmentAllowedCharacterSet  <span class="comment">//  "####%&lt;&gt;[\]^`&#123;|&#125;</span></div><div class="line">URLHostAllowedCharacterSet      <span class="comment">//  "####%/&lt;&gt;?@\^`&#123;|&#125;</span></div><div class="line">URLPasswordAllowedCharacterSet  <span class="comment">//  "####%/:&lt;&gt;?@[\]^`&#123;|&#125;</span></div><div class="line">URLPathAllowedCharacterSet      <span class="comment">//  "####%;&lt;&gt;?[\]^`&#123;|&#125;</span></div><div class="line">URLQueryAllowedCharacterSet     <span class="comment">//  "####%&lt;&gt;[\]^`&#123;|&#125;</span></div><div class="line">URLUserAllowedCharacterSet      <span class="comment">//  "####%/:&lt;&gt;?@[\]^`</span></div></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//swift3写法</span></div><div class="line">let allowedCharacterSet = (CharacterSet(charactersIn: <span class="string">"!*'();:@&amp;=+$,/?%####[] "</span>).inverted)</div><div class="line"></div><div class="line"><span class="keyword">if</span> let escapedString = originalString.addingPercentEncoding(withAllowedCharacters: allowedCharacterSet) &#123;</div><div class="line"><span class="comment">//do something with escaped string</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h4&gt;&lt;p&gt;今天遇到一个问题，本地将一个对象转成JSON字符串后传给后台，由于出现特殊字符&amp;amp;导致后台无法正确处理该字符串。经过一番Google，现将问题及解决方法记录如下。&lt;/p&gt;
&lt;h4 id=&quot;解决方案&quot;&gt;&lt;a href=&quot;#解决方案&quot; class=&quot;headerlink&quot; title=&quot;解决方案&quot;&gt;&lt;/a&gt;解决方案&lt;/h4&gt;&lt;p&gt;附上stackoverflow地址 &lt;a href=&quot;http://stackoverflow.com/questions/24551816/swift-encode-url&quot;&gt;http://stackoverflow.com/questions/24551816/swift-encode-url&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;附上常用字符集的解释 注释部分是对应的处理特殊字符的内容&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
  <entry>
    <title>iOS 获取当前屏幕显示的UIViewController</title>
    <link href="http://www.wangquanwei.com/2017-02-24-1.html"/>
    <id>http://www.wangquanwei.com/2017-02-24-1.html</id>
    <published>2017-02-24T12:54:40.000Z</published>
    <updated>2017-04-27T13:33:45.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>接到上级任务，需要给app新增一个检测版本更新的功能(299$账号 不上App Store)。<br>本文不讨论如何实现一个更新检测功能。</p>
<h4 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h4><p>1、新建一个继承NSObject的子类。<br>2、调用网络接口，将服务器版本号与本地版本号对比，得出是否需要弹出更新提示。<br>3、因为最低版本支持iOS8，所以使用iOS8新出的api UIAlertViewController。</p>
<p>那么问题来了,要弹出UIAlertViewController就必须使用如下方法，该方法又是UIViewController的方法,总不能外部传个ViewController进来吧？<a id="more"></a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)presentViewController:(<span class="built_in">UIViewController</span> *)viewControllerToPresent animated: (<span class="built_in">BOOL</span>)flag completion:(<span class="keyword">void</span> (^ __<span class="keyword">nullable</span>)(<span class="keyword">void</span>))completion <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">5</span>_0);</div></pre></td></tr></table></figure>
<h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取当前屏幕显示的UIViewController </span></div><div class="line"><span class="comment">//objc写法</span></div><div class="line">- (<span class="built_in">UIViewController</span> *)currentViewController &#123;</div><div class="line"></div><div class="line">    <span class="built_in">UIViewController</span> * result;</div><div class="line">    <span class="built_in">UIWindow</span> * window = [<span class="built_in">UIApplication</span> sharedApplication].keyWindow;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (window.windowLevel != <span class="built_in">UIWindowLevelNormal</span>) &#123;</div><div class="line"></div><div class="line">        <span class="built_in">NSArray</span> * windows = [<span class="built_in">UIApplication</span> sharedApplication].windows;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">UIWindow</span> * tmpWin <span class="keyword">in</span> windows) &#123;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (tmpWin.windowLevel == <span class="built_in">UIWindowLevelNormal</span>) &#123;</div><div class="line">                window = tmpWin;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">UIView</span> * frontView = window.subviews.firstObject;</div><div class="line">    <span class="built_in">UIResponder</span> * nextResponder = frontView.nextResponder;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> ([nextResponder isKindOfClass:[<span class="built_in">UIViewController</span> <span class="keyword">class</span>]]) &#123;</div><div class="line">        result = (<span class="built_in">UIViewController</span> *)nextResponder;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        result = window.rootViewController;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取当前屏幕显示的UIViewController </span></div><div class="line"><span class="comment">//swift 写法</span></div><div class="line">func currentViewController() -&gt; <span class="built_in">UIViewController</span>? &#123;</div><div class="line"></div><div class="line">    var result : <span class="built_in">UIViewController</span>?</div><div class="line">    var window = <span class="built_in">UIApplication</span>.shared.keyWindow</div><div class="line"></div><div class="line">    <span class="keyword">if</span> window?.windowLevel != <span class="built_in">UIWindowLevelNormal</span> &#123;</div><div class="line"></div><div class="line">        let windows = <span class="built_in">UIApplication</span>.shared.windows</div><div class="line">        <span class="keyword">for</span> tmpWin <span class="keyword">in</span> windows &#123;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> tmpWin.windowLevel == <span class="built_in">UIWindowLevelNormal</span> &#123;</div><div class="line">                window = tmpWin</div><div class="line">                <span class="keyword">break</span></div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    let frontView = window?.subviews.first</div><div class="line">    let nextResponder = frontView?.next</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (nextResponder?.isKind(of: <span class="built_in">UIViewController</span>.self))! &#123;</div><div class="line">        result = nextResponder as! <span class="built_in">UIViewController</span>?</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        result = window?.rootViewController</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>================= 2017.03.10更新 =================</p>
<p>针对在rootViewController的viewDidLoad里调用UIApplication.shared.keyWindow时会出现keyWindow为nil的情况作出解释</p>
<p>keyWindow设置过程<br>1、初始化AppDelegate的window。<br>2、初始化rootViewController。<br>3、设置window的rootViewController。<br>4、调用[self.window makeKeyAndVisible]方法设置window为keyWindow并让window显示在屏幕上。此时keyWindow才不为nil。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h4&gt;&lt;p&gt;接到上级任务，需要给app新增一个检测版本更新的功能(299$账号 不上App Store)。&lt;br&gt;本文不讨论如何实现一个更新检测功能。&lt;/p&gt;
&lt;h4 id=&quot;设计思路&quot;&gt;&lt;a href=&quot;#设计思路&quot; class=&quot;headerlink&quot; title=&quot;设计思路&quot;&gt;&lt;/a&gt;设计思路&lt;/h4&gt;&lt;p&gt;1、新建一个继承NSObject的子类。&lt;br&gt;2、调用网络接口，将服务器版本号与本地版本号对比，得出是否需要弹出更新提示。&lt;br&gt;3、因为最低版本支持iOS8，所以使用iOS8新出的api UIAlertViewController。&lt;/p&gt;
&lt;p&gt;那么问题来了,要弹出UIAlertViewController就必须使用如下方法，该方法又是UIViewController的方法,总不能外部传个ViewController进来吧？
    
    </summary>
    
      <category term="iOS" scheme="http://www.wangquanwei.com/categories/iOS/"/>
    
    
  </entry>
  
</feed>
